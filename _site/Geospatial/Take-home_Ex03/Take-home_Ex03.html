<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-11">

<title>personalprojects - Take-home Exercise 3: Predicting HDB Public Housing Resale Pricies using Geographically Weighted Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">personalprojects</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-geospatial-analytics" role="button" data-bs-toggle="dropdown" aria-expanded="false">Geospatial Analytics</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-geospatial-analytics">    
        <li>
    <a class="dropdown-item" href="../../Geospatial/Introduction.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Geospatial/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Spatial Point Pattern Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Geospatial/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Exploratory Spatial Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Geospatial/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Geographically Weighted Regression</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistical-learning-with-r" role="button" data-bs-toggle="dropdown" aria-expanded="false">Statistical Learning with R</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistical-learning-with-r">    
        <li>
    <a class="dropdown-item" href="../../Statistical-learning/Introduction.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Statistical-learning/project/Stat-learning-1.html">
 <span class="dropdown-text">Explanatory Regression Model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Statistical-learning/project/Stat-learning-2.html">
 <span class="dropdown-text">Predictive Regression Model</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-text-analytics" role="button" data-bs-toggle="dropdown" aria-expanded="false">Text-analytics</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-text-analytics">    
        <li>
    <a class="dropdown-item" href="../../Text-analytics/Intro-to-text-analytics/Intro-to-text-analytics.html">
 <span class="dropdown-text">Intro to Text Analytics</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About Me</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#task" id="toc-task" class="nav-link active" data-scroll-target="#task"><span class="toc-section-number">1</span>  Task</a></li>
  <li><a href="#installing-packages" id="toc-installing-packages" class="nav-link" data-scroll-target="#installing-packages"><span class="toc-section-number">2</span>  Installing packages</a>
  <ul class="collapse">
  <li><a href="#onemapapi-usage" id="toc-onemapapi-usage" class="nav-link" data-scroll-target="#onemapapi-usage"><span class="toc-section-number">2.1</span>  OneMapAPI: usage</a></li>
  </ul></li>
  <li><a href="#data-collection-1" id="toc-data-collection-1" class="nav-link" data-scroll-target="#data-collection-1"><span class="toc-section-number">3</span>  Data Collection</a>
  <ul class="collapse">
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data"><span class="toc-section-number">3.1</span>  Aspatial data</a></li>
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data"><span class="toc-section-number">3.2</span>  Geospatial Data</a></li>
  <li><a href="#reading-collected-geospatial-data-into-r" id="toc-reading-collected-geospatial-data-into-r" class="nav-link" data-scroll-target="#reading-collected-geospatial-data-into-r"><span class="toc-section-number">3.3</span>  Reading collected geospatial data into R</a></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing"><span class="toc-section-number">3.4</span>  Data pre-processing</a></li>
  <li><a href="#verifying-transforming-coordinate-system" id="toc-verifying-transforming-coordinate-system" class="nav-link" data-scroll-target="#verifying-transforming-coordinate-system"><span class="toc-section-number">3.5</span>  Verifying + Transforming Coordinate system</a></li>
  <li><a href="#transforming-crs" id="toc-transforming-crs" class="nav-link" data-scroll-target="#transforming-crs"><span class="toc-section-number">3.6</span>  Transforming CRS</a></li>
  <li><a href="#checking-crs" id="toc-checking-crs" class="nav-link" data-scroll-target="#checking-crs"><span class="toc-section-number">3.7</span>  Checking crs</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="toc-section-number">4</span>  Exploratory Data Analysis</a></li>
  <li><a href="#data-wrangling-1" id="toc-data-wrangling-1" class="nav-link" data-scroll-target="#data-wrangling-1"><span class="toc-section-number">5</span>  Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#structural-factors" id="toc-structural-factors" class="nav-link" data-scroll-target="#structural-factors"><span class="toc-section-number">5.1</span>  Structural Factors</a></li>
  <li><a href="#locational-factors" id="toc-locational-factors" class="nav-link" data-scroll-target="#locational-factors"><span class="toc-section-number">5.2</span>  Locational Factors</a></li>
  </ul></li>
  <li><a href="#regressions-1" id="toc-regressions-1" class="nav-link" data-scroll-target="#regressions-1"><span class="toc-section-number">6</span>  Regressions</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="toc-section-number">6.1</span>  Data Preparation</a></li>
  <li><a href="#building-a-non-spatial-multiple-linear-regression" id="toc-building-a-non-spatial-multiple-linear-regression" class="nav-link" data-scroll-target="#building-a-non-spatial-multiple-linear-regression"><span class="toc-section-number">6.2</span>  Building a non spatial multiple linear regression</a></li>
  <li><a href="#gwr-predictive-method" id="toc-gwr-predictive-method" class="nav-link" data-scroll-target="#gwr-predictive-method"><span class="toc-section-number">6.3</span>  GWR predictive method</a></li>
  <li><a href="#preparing-coordinates-data" id="toc-preparing-coordinates-data" class="nav-link" data-scroll-target="#preparing-coordinates-data"><span class="toc-section-number">6.4</span>  Preparing coordinates data</a></li>
  <li><a href="#calibrating-random-forest-model" id="toc-calibrating-random-forest-model" class="nav-link" data-scroll-target="#calibrating-random-forest-model"><span class="toc-section-number">6.5</span>  Calibrating Random Forest Model</a></li>
  <li><a href="#calibrating-geographic-random-forest-using-grf" id="toc-calibrating-geographic-random-forest-using-grf" class="nav-link" data-scroll-target="#calibrating-geographic-random-forest-using-grf"><span class="toc-section-number">6.6</span>  Calibrating Geographic random forest using grf</a></li>
  </ul></li>
  <li><a href="#predictions" id="toc-predictions" class="nav-link" data-scroll-target="#predictions"><span class="toc-section-number">7</span>  Predictions</a>
  <ul class="collapse">
  <li><a href="#preparing-the-test-data" id="toc-preparing-the-test-data" class="nav-link" data-scroll-target="#preparing-the-test-data"><span class="toc-section-number">7.1</span>  Preparing the test data</a></li>
  <li><a href="#predicting-with-test-data" id="toc-predicting-with-test-data" class="nav-link" data-scroll-target="#predicting-with-test-data"><span class="toc-section-number">7.2</span>  Predicting with test data</a></li>
  <li><a href="#converting-the-prediction-output-into-a-dataframe" id="toc-converting-the-prediction-output-into-a-dataframe" class="nav-link" data-scroll-target="#converting-the-prediction-output-into-a-dataframe"><span class="toc-section-number">7.3</span>  Converting the prediction output into a dataframe</a></li>
  <li><a href="#calculating-root-mean-square-error" id="toc-calculating-root-mean-square-error" class="nav-link" data-scroll-target="#calculating-root-mean-square-error"><span class="toc-section-number">7.4</span>  Calculating Root Mean Square Error</a></li>
  <li><a href="#visualising-the-predicted-values" id="toc-visualising-the-predicted-values" class="nav-link" data-scroll-target="#visualising-the-predicted-values"><span class="toc-section-number">7.5</span>  Visualising the predicted values</a></li>
  </ul></li>
  <li><a href="#conclusions-comparisons" id="toc-conclusions-comparisons" class="nav-link" data-scroll-target="#conclusions-comparisons"><span class="toc-section-number">8</span>  Conclusions: Comparisons</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">9</span>  References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-home Exercise 3: Predicting HDB Public Housing Resale Pricies using Geographically Weighted Methods</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 11, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="task" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="task"><span class="header-section-number">1</span> Task</h2>
<p>Pandemic-induced supply chain constraints coinciding with the booming demand for flats have driven HDB resale prices up by 10.3% in 2022. For young couples deciding to buy a home to stay in, it seems nearly impossible to do so especially with the exorbitantly high price tags attached to flats recently.</p>
<p>This has caused many to think about what are the factors that affect the prices of HDB resale flats– some of which may be geographical in nature. For instance, some may pioritise of living near the local MRT, while others may focus on the location of schools within the vicinity of a flat.</p>
<p>In this take-home exercise, we will build a predictive model for the month of January and February 2023 in Singapore. The predictive models must be built by using by using conventional OLS method and GWR methods. Lastly, we will compare the performance of the conventional OLS method versus the geographical weighted methods.</p>
<p>The assignment submission is split into the following sections</p>
<ol type="1">
<li><p><a href="#installing-packages">Installing packages</a></p></li>
<li><p><a href="#data-collection-1">Data Collection</a></p></li>
<li><p><a href="#exploratory-data-analysis">Exploratory Data Analysis</a></p></li>
<li><p><a href="#data-wrangling-1">Data Wrangling</a></p></li>
<li><p><a href="#regressions-1">Regressions</a></p></li>
<li><p><a href="#predictions">Predictions</a></p></li>
<li><p><a href="#references">References</a></p></li>
</ol>
</section>
<section id="installing-packages" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="installing-packages"><span class="header-section-number">2</span> Installing packages</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary, sfdep, onemapsgapi, stringr, SpatialML, devtools, tidymodels, kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The uses of each package installed can be found below:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Data Collection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Data Wrangling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Data Visualisation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Regressions</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p>kableExtra: an extension of kable, used for table customisation</p></li>
<li><p>onemapsgapi: used to query Singapore-specifif spatial data, alongside additional functionalities</p></li>
<li><p>httr: used to make API calls, such as GET requests</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li><p>sf: used for importing, managing and processing geospatial data</p></li>
<li><p>spdep: used to create spatial weight matrix objects, global and local spatial autocorrelation statistics and related calculations</p></li>
<li><p>sfdep: builds on spdep to create sn sf and tidyverse friendly interface to the package</p></li>
<li><p>tidyverse: collection of R packages designed for data wrangling</p></li>
<li><p>stringr: provides a cohesive set of functions designed to make working with strings easily</p></li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<ul>
<li>tmap: used for creating thematic maps, such as chloropleth and bubble maps</li>
</ul>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<ul>
<li><p>olsrr: used for building least square regression models</p></li>
<li><p>corrplot + ggpubr: Used for multivariate data visualisation and analysis</p></li>
<li><p>GWmodel: provides a collection of localised spatial statistical methods such as summary statistic, principal components analysis, discriminant analysis and various forms of GW regression</p></li>
<li><p>gtsummary: provides an elegant and flexible way to create publication-ready analytical and summary tables using the <strong>R</strong> programming language</p></li>
<li><p>devtools: used for installing any R packages which is not available in RCRAN</p></li>
<li><p>SpatialML: allows for a geographically weighted random forest regression to include a function to find the optimal bandwidth</p></li>
</ul>
</div>
</div>
</div>
<section id="onemapapi-usage" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="onemapapi-usage"><span class="header-section-number">2.1</span> OneMapAPI: usage</h3>
<p>In this exercise, the collection of the coordinate data of singapore-specific places can tap on the database implemented by <a href="https://www.onemap.gov.sg/main/v2/">OneMapSg</a>. 🏠</p>
<p>Referencing one of our senior <a href="https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/">Megan’s</a> work, the steps to intialise this processes is as follows:</p>
<ol type="1">
<li>Make sure you have your token value after signing up for a OneMapSG account</li>
<li>Search for the specified theme with search_themes(token, “searchval”).</li>
<li>Check the theme status with get_theme_status(token, “themename”)</li>
<li>From here, we can convert our tibble dataframe to simple features dataframe. All the themes for this project use Lat and Lng as the latitude and longitude respectively, and our project coordinates system should be in the WGS84 system, aka ESPG code 4326. Thus, <code>themesf &lt;- st_as_sf(themetibble, coords=c("Lng", "Lat"), crs=4326)</code></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(onemapsgapi)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>token <span class="ot">&lt;-</span> <span class="st">"your value"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">search_themes</span>(token, <span class="st">"searchval"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(token, <span class="st">"themename"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>themetibble <span class="ot">&lt;-</span> <span class="fu">get_theme</span>(token, <span class="st">"themename"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>themesf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(themetibble, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>This token will expire on 2023-08-21 15:20:52</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 477 × 7
   THEMENAME                       QUERY…¹ ICON  CATEG…² THEME…³ EXPIR…⁴ PUBLI…⁵
   &lt;chr&gt;                           &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;named&gt; &lt;named&gt;
 1 MCE KPE Speed Camera            mce_kp… icon… Commun… LAND T… &lt;chr&gt;   &lt;chr&gt;  
 2 MCE KPE Speed Camera            mce_kp… icon… Commun… LAND T… &lt;int&gt;   &lt;int&gt;  
 3 MCE KPE Speed Camera            mce_kp… icon… Commun… LAND T… &lt;chr&gt;   &lt;chr&gt;  
 4 Singapore Police Force Mobile … spf_msc Spee… Commun… SINGAP… &lt;chr&gt;   &lt;chr&gt;  
 5 Singapore Police Force Mobile … spf_msc Spee… Commun… SINGAP… &lt;int&gt;   &lt;int&gt;  
 6 Singapore Police Force Mobile … spf_msc Spee… Commun… SINGAP… &lt;chr&gt;   &lt;chr&gt;  
 7 Liquor Control Zone(s) proclai… liquor… Cres… Commun… SINGAP… &lt;chr&gt;   &lt;chr&gt;  
 8 Liquor Control Zone(s) proclai… liquor… Cres… Commun… SINGAP… &lt;int&gt;   &lt;int&gt;  
 9 Liquor Control Zone(s) proclai… liquor… Cres… Commun… SINGAP… &lt;chr&gt;   &lt;chr&gt;  
10 Singapore Police Force - 32nd … as_ist… Cres… Commun… SINGAP… &lt;chr&gt;   &lt;chr&gt;  
# … with 467 more rows, and abbreviated variable names ¹​QUERYNAME, ²​CATEGORY,
#   ³​THEME_OWNER, ⁴​EXPIRY_DATE, ⁵​PUBLISHED_DATE</code></pre>
</div>
</div>
<p>With that in mind, lets move on to data collection! 🙃</p>
</section>
</section>
<section id="data-collection-1" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="data-collection-1"><span class="header-section-number">3</span> Data Collection</h2>
<p>The following data would be used for the formation of our regression</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialise a dataframe of our aspatial and geospatial dataset details</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type=</span><span class="fu">c</span>(<span class="st">"Aspatial"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(<span class="st">"Resale Flat Prices"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Master Plan 2019 Subzone Boundary (Web)"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Childcare Services"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Eldercare Services"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Hawker Centres"</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Kindergartens"</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Parks"</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Libraries"</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sport Facilities"</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Bus Stop Locations Aug 2021"</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">"MRT &amp; LRT Locations Aug 2021"</span>,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Supermarkets"</span>,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Shopping Mall SVY21 Coordinates"</span>, </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Primary School"</span>),</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">Format=</span><span class="fu">c</span>(<span class="st">".csv"</span>, </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>           <span class="st">".kml"</span>,</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>           <span class="st">".csv"</span>),</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">Source=</span><span class="fu">c</span>(<span class="st">"[data.gov.sg](https://data.gov.sg/dataset/resale-flat-prices)"</span>,</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[data.gov.sg](https://data.gov.sg/dataset/master-plan-2014-subzone-boundary-web)"</span>,</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[datamall.lta](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop)"</span>,</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[data.gov](https://data.gov.sg/dataset/lta-mrt-station-exit)"</span>,</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[Onemap.gov](https://www.onemap.gov.sg/main/v2/essentialamenities)"</span>,</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[Valery Lim's Github](https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper/blob/master/mall_coordinates_updated.csv)"</span>,</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[data.gov](https://data.gov.sg/dataset/school-directory-and-information)"</span>)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(datasets, <span class="at">caption=</span><span class="st">"Datasets Used"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>(<span class="st">"hover"</span>, <span class="at">latex_options=</span><span class="st">"scale_down"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-material lightable-hover" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Datasets Used</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Type </th>
   <th style="text-align:left;"> Name </th>
   <th style="text-align:left;"> Format </th>
   <th style="text-align:left;"> Source </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Aspatial </td>
   <td style="text-align:left;"> Resale Flat Prices </td>
   <td style="text-align:left;"> .csv </td>
   <td style="text-align:left;"> [data.gov.sg](https://data.gov.sg/dataset/resale-flat-prices) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial </td>
   <td style="text-align:left;"> Master Plan 2019 Subzone Boundary (Web) </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [data.gov.sg](https://data.gov.sg/dataset/master-plan-2014-subzone-boundary-web) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Extracted </td>
   <td style="text-align:left;"> Childcare Services </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Extracted </td>
   <td style="text-align:left;"> Eldercare Services </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Extracted </td>
   <td style="text-align:left;"> Hawker Centres </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Extracted </td>
   <td style="text-align:left;"> Kindergartens </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Extracted </td>
   <td style="text-align:left;"> Parks </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Extracted </td>
   <td style="text-align:left;"> Libraries </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Extracted </td>
   <td style="text-align:left;"> Sport Facilities </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Selfsourced </td>
   <td style="text-align:left;"> Bus Stop Locations Aug 2021 </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [datamall.lta](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Selfsourced </td>
   <td style="text-align:left;"> MRT &amp; LRT Locations Aug 2021 </td>
   <td style="text-align:left;"> .kml </td>
   <td style="text-align:left;"> [data.gov](https://data.gov.sg/dataset/lta-mrt-station-exit) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Selfsourced </td>
   <td style="text-align:left;"> Supermarkets </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [Onemap.gov](https://www.onemap.gov.sg/main/v2/essentialamenities) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Selfsourced </td>
   <td style="text-align:left;"> Shopping Mall SVY21 Coordinates </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [Valery Lim's Github](https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper/blob/master/mall_coordinates_updated.csv) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Selfsourced </td>
   <td style="text-align:left;"> Primary School </td>
   <td style="text-align:left;"> .csv </td>
   <td style="text-align:left;"> [data.gov](https://data.gov.sg/dataset/school-directory-and-information) </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="aspatial-data" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="aspatial-data"><span class="header-section-number">3.1</span> Aspatial data</h3>
<p>For the purpose of this take-home exercise, <a href="https://data.gov.sg/dataset/resale-flat-prices"><code>HDB Resale Flat Prices</code></a> provided by Data.gov.sg should be used as the core data set.</p>
<p>The code chunk below reads the csv file into our R environment.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>resale<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"data/aspatial/resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resale,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="filtering-to-include-transactional-periods" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="filtering-to-include-transactional-periods"><span class="header-section-number">3.1.1</span> Filtering to include transactional periods</h4>
<p>The study should focus on either three-room, four-room or five-room flat and transaction period should be from 1st January 2021 to 31st December 2022. The test data should be January and February 2023 resale prices.</p>
<p>Therefore, we filter the dataset to include transactions occuring from Jan 2021 to Feb 2023.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transaction period from 01-Jan-21 to 31-Feb-23</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4-room flats </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>resale <span class="ot">&lt;-</span> resale <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(flat_type <span class="sc">==</span> <span class="st">"4 ROOM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2021-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2022-12"</span> <span class="sc">|</span> month <span class="sc">&gt;=</span> <span class="st">"2023-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2023-02"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>street_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ST</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">"SAINT"</span>, resale<span class="sc">$</span>street_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="creating-function-to-get-longitude-and-lattitude" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="creating-function-to-get-longitude-and-lattitude"><span class="header-section-number">3.1.2</span> Creating function to get longitude and lattitude</h4>
<p>Notice that the data provided in the resale flat data does not include coordinates! We need to create our own geocoding function. With reference to our senior Megan’s work once again, these are the steps required in creating a geocoding function.</p>
<ol type="1">
<li><p>Combine the block and street name into an address</p></li>
<li><p>Pass the address as the searchVal in our query</p></li>
<li><p>Send the query to OneMapSG search <em>Note: Since we don’t need all the address details, we can set <code>getAddrDetails</code> as ‘N’</em></p></li>
<li><p>Convert response (JSON object) to text</p></li>
<li><p>Save response in text form as a dataframe</p></li>
<li><p>We only need to retain the latitude and longitude for our output</p></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjson)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>geocode <span class="ot">&lt;-</span> <span class="cf">function</span>(block, streetname) {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://developers.onemap.sg/commonapi/search"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  address <span class="ot">&lt;-</span> <span class="fu">paste</span>(block, streetname, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"searchVal"</span> <span class="ot">=</span> address, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"returnGeom"</span> <span class="ot">=</span> <span class="st">"Y"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"getAddrDetails"</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pageNum"</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  restext<span class="ot">&lt;-</span><span class="fu">content</span>(res, <span class="at">as=</span><span class="st">"text"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(restext)  <span class="sc">%&gt;%</span> </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(results.LATITUDE, results.LONGITUDE)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="passing-code-through-resale-df" class="level4" data-number="3.1.3">
<h4 data-number="3.1.3" class="anchored" data-anchor-id="passing-code-through-resale-df"><span class="header-section-number">3.1.3</span> Passing code through resale df</h4>
<p>With our function in place, we then create a loop to implement the geocoding function through our transaction data. ✌🏼</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale)){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(resale[i, <span class="dv">4</span>], resale[i, <span class="dv">5</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  resale<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  resale<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="save-as-an-rds-object" class="level4" data-number="3.1.4">
<h4 data-number="3.1.4" class="anchored" data-anchor-id="save-as-an-rds-object"><span class="header-section-number">3.1.4</span> Save as an RDS object</h4>
<p>Especially given the extensive dataframe, this would take quite long to load! to avoid having to reload the output again, we save this as a RDS object 😵‍💫.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(resale, <span class="at">file=</span><span class="st">"resale"</span>, <span class="at">compress=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>now we can read the resale file easily! 🤭</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>resale<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">"resale"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="geospatial-data" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="geospatial-data"><span class="header-section-number">3.2</span> Geospatial Data</h3>
<p>Our geospatial data can be split into several categories</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 16%">
<col style="width: 35%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Base</th>
<th>Extracted</th>
<th>Sourced</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Description</td>
<td>geographical boundaries</td>
<td>Independent variable data extracted using OneMap API</td>
<td>Independent variable data extracted from the internet</td>
</tr>
<tr class="even">
<td>Layer names</td>
<td><ol type="1">
<li>MPSZ-2019</li>
</ol></td>
<td><p>childcare</p>
<p>elder care</p>
<p>hawker centre</p>
<p>kindergartens</p>
<p>parks</p>
<p>libraries</p>
<p>sport facilities</p></td>
<td><ol type="1">
<li><p>bus stop</p></li>
<li><p>shopping mall</p></li>
<li><p>supermarket</p></li>
<li><p>mrt</p></li>
<li><p>primary school</p></li>
<li><p>good primary school</p></li>
</ol></td>
</tr>
</tbody>
</table>
<p>Feel free to explore the codes we used to extract the data in the different panels below! 🤗</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Extracted</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Sourced</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(onemapsgapi)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting eldercare data as an sf object into R</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>eldercare<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"eldercare"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>eldercare.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(eldercare, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> eldercare.sf,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"eldercare"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting eldercare data as an sf object into R</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>hawkercentre<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"hawkercentre"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(hawkercentre, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> hawkercentre.sf,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"hawkercentre"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting childcare data as an sf object into R</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>childcare<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"childcare"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>childcare.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(childcare, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> childcare.sf,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"childcare"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting kindergartens data as an sf object into R</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>kindergartens<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"kindergartens"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>kindergartens.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(kindergartens, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> kindergartens.sf,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"kindergartens"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting parks data as an sf object into R</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>parks<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"nationalparks"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>parks.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(parks, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> parks.sf,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"parks"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting library data as an sf object into R</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>library<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"libraries"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>library.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(library, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> library.sf,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"libraries"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Extracting and sports facility data:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sport<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"sportsg_sport_facilities"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>sport</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/Screenshot%202023-03-11%20at%205.46.23%20PM.png" class="img-fluid"></p>
<p>When we browse the sports data, we see that the lat and lng columns are not configured in the way we expect it to be. In the Lng column, the longitude of the location is first placed followed by a “|” and then the latitude of the location. 🥲</p>
<p>Notice that the Lng and Lat are not in the format we want. We create a function to extract the Lng numbers from the string, using str_extract from the package stringr.</p>
<p>note the use of the following syntax</p>
<ul>
<li><p>“\\d+” extracts one or more digits that occur before the | character</p></li>
<li><p>“\.?” matches the decimal point occuring in lng records</p></li>
<li><p>“\d*” matches any digits that come after the decimal point</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lng.mutate<span class="ot">&lt;-</span><span class="cf">function</span>(df){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Lng=</span><span class="fu">str_extract</span>(Lng, <span class="st">"</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*"</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting sports data as an sf object into R</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sport<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"sportsg_sport_facilities"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sport<span class="ot">&lt;-</span><span class="fu">lng.mutate</span>(sport)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>sport.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sport, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> sport.sf,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"sportsg_sport_facilities"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<ol type="1">
<li><p>Bus stop data Extracted from: <a href="https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop">datamall.lta</a></p></li>
<li><p>Supermarkets extracted data from: <a href="https://www.onemap.gov.sg/main/v2/essentialamenities">Onemap.gov</a></p></li>
<li><p>Shopping mall data Extracted from: <a href="https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper/blob/master/mall_coordinates_updated.csv">ValeryLim’s Github</a></p></li>
</ol>
<p>since it is in a csv file, we convert it into a shape file and save it into our extracted data file in the code chunk below</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mall.df<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/geospatial/sourced/mall_coordinates_updated.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(latitude, longitude, name) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(name)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>mall.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(mall.df, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> mall.sf,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"shoppingmall"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="4" type="1">
<li>Primary school data extracted from <a href="https://data.gov.sg/dataset/school-directory-and-information">data.gov</a></li>
</ol>
<p>Since only postal code and address data is given, we use the OneMapAPI in the code below to obtain coordinates of the schools.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>primarysch.df<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/geospatial/sourced/general-information-of-schools.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(mainlevel_code<span class="sc">==</span><span class="st">"PRIMARY"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(school_name, postal_code) <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">postal_code=</span><span class="fu">ifelse</span>(<span class="fu">nchar</span>(<span class="fu">as.character</span>(postal_code)) <span class="sc">==</span> <span class="dv">5</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">paste0</span>(<span class="st">"0"</span>, <span class="fu">as.character</span>(postal_code)), </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.character</span>(postal_code)))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#use onemap api</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjson)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>geocode.data.gov <span class="ot">&lt;-</span> <span class="cf">function</span>(postalcode) {</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://developers.onemap.sg/commonapi/search"</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"searchVal"</span> <span class="ot">=</span> postalcode, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"returnGeom"</span> <span class="ot">=</span> <span class="st">"Y"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"getAddrDetails"</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pageNum"</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  restext<span class="ot">&lt;-</span><span class="fu">content</span>(res, <span class="at">as=</span><span class="st">"text"</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(restext) <span class="sc">|&gt;</span>  </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(results.LATITUDE, results.LONGITUDE)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co">#create loop to run data through</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>primarysch.df<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>primarysch.df<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(primarysch.df)){</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode.data.gov</span>(primarysch.df[i, <span class="dv">2</span>])</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  primarysch.df<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  primarysch.df<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>primarysch.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(primarysch.df, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> primarysch.sf,</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"primarysch"</span>,</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="5" type="1">
<li>Good primary school - filtered from primarysch.sf</li>
</ol>
<p>Based on the rankings of <a href="https://schlah.com/primary-schools">this website</a>, we take the first 10 schools</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>primarysch.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"primarysch"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf <span class="ot">&lt;-</span> primarysch.sf <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(school_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"NANYANG PRIMARY SCHOOL"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"TAO NAN SCHOOL"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"CANOSSA CATHOLIC PRIMARY SCHOOL"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"NAN HUA PRIMARY SCHOOL"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"ST. HILDA'S PRIMARY SCHOOL"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"HENRY PARK PRIMARY SCHOOL"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"ANGLO-CHINESE SCHOOL (PRIMARY)"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"RAFFLES GIRLS' PRIMARY SCHOOL"</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PEI HWA PRESBYTERIAN PRIMARY SCHOOL"</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                            ))</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> goodprimarysch.sf,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"goodprimarysch"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="6" type="1">
<li>Mrt data: retrieved from <a href="https://data.gov.sg/dataset/lta-mrt-station-exit">data.gov</a></li>
</ol>
<p>The data given to us is in “.kml” format, we convert it to an sf object.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn=</span> <span class="st">"data/geospatial/sourced/lta-mrt-station-exit-kml.kml"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_zm</span>()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> mrt.sf,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"mrt"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">append =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="reading-collected-geospatial-data-into-r" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="reading-collected-geospatial-data-into-r"><span class="header-section-number">3.3</span> Reading collected geospatial data into R</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Extracted</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Sourced</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mpsz.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/base"</span>, <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/base' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XYZ
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
z_range:       zmin: 0 zmax: 0
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>eldercare.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"eldercare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `eldercare' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/extracted' 
  using driver `ESRI Shapefile'
Simple feature collection with 133 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.7119 ymin: 1.271472 xmax: 103.9561 ymax: 1.439561
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"hawkercentre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `hawkercentre' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/extracted' 
  using driver `ESRI Shapefile'
Simple feature collection with 125 features and 18 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6974 ymin: 1.272716 xmax: 103.9882 ymax: 1.449017
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>childcare.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"childcare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `childcare' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/extracted' 
  using driver `ESRI Shapefile'
Simple feature collection with 1925 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>kindergartens.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"kindergartens"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `kindergartens' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/extracted' 
  using driver `ESRI Shapefile'
Simple feature collection with 448 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6887 ymin: 1.247759 xmax: 103.9717 ymax: 1.455452
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>parks.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"parks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `parks' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/extracted' 
  using driver `ESRI Shapefile'
Simple feature collection with 421 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6929 ymin: 1.214491 xmax: 104.0538 ymax: 1.462094
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>library.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"libraries"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `libraries' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/extracted' 
  using driver `ESRI Shapefile'
Simple feature collection with 31 features and 13 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.7045 ymin: 1.263922 xmax: 103.9494 ymax: 1.448197
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sport.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"sportsg_sport_facilities"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `sportsg_sport_facilities' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/extracted' 
  using driver `ESRI Shapefile'
Simple feature collection with 35 features and 8 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6937 ymin: 1.287668 xmax: 103.9524 ymax: 1.435755
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>busstop.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"BusStop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/sourced' 
  using driver `ESRI Shapefile'
Simple feature collection with 5159 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"shoppingmall"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `shoppingmall' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/sourced' 
  using driver `ESRI Shapefile'
Simple feature collection with 184 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6784 ymin: 1.263797 xmax: 103.9897 ymax: 1.448227
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>supermarket.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"SUPERMARKETS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `SUPERMARKETS' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/sourced' 
  using driver `ESRI Shapefile'
Simple feature collection with 526 features and 8 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4901.188 ymin: 25529.08 xmax: 46948.22 ymax: 49233.6
Projected CRS: SVY21</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"mrt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mrt' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/sourced' 
  using driver `ESRI Shapefile'
Simple feature collection with 474 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6368 ymin: 1.264972 xmax: 103.9893 ymax: 1.449157
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>primarysch.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"primarysch"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `primarysch' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/sourced' 
  using driver `ESRI Shapefile'
Simple feature collection with 183 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6878 ymin: 1.274958 xmax: 103.9628 ymax: 1.456608
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"goodprimarysch"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `goodprimarysch' from data source 
  `/Users/pengyouyun/youyunpeng/personalprojects/Geospatial/Take-home_Ex03/data/geospatial/sourced' 
  using driver `ESRI Shapefile'
Simple feature collection with 9 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.7611 ymin: 1.305285 xmax: 103.937 ymax: 1.34968
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-pre-processing" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="data-pre-processing"><span class="header-section-number">3.4</span> Data pre-processing</h3>
<section id="removing-unnecessary-columns" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="removing-unnecessary-columns"><span class="header-section-number">3.4.1</span> <strong>Removing unnecessary columns</strong></h4>
<p>For locational factor dataframes, we only need to know the name of the facility and its geometry column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>eldercare.sf<span class="ot">&lt;-</span><span class="fu">select</span>(eldercare.sf, <span class="dv">1</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf<span class="ot">&lt;-</span><span class="fu">select</span>(hawkercentre.sf, <span class="dv">1</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>childcare.sf<span class="ot">&lt;-</span><span class="fu">select</span>(childcare.sf, <span class="dv">1</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>parks.sf<span class="ot">&lt;-</span><span class="fu">select</span>(parks.sf, <span class="dv">1</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>library.sf<span class="ot">&lt;-</span><span class="fu">select</span>(library.sf, <span class="dv">1</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>sport.sf<span class="ot">&lt;-</span><span class="fu">select</span>(sport.sf, <span class="dv">1</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf<span class="ot">&lt;-</span><span class="fu">select</span>(shoppingmall.sf, <span class="dv">1</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>busstop.sf<span class="ot">&lt;-</span><span class="fu">select</span>(busstop.sf, <span class="dv">1</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>supermarket.sf<span class="ot">&lt;-</span> <span class="fu">select</span>(supermarket.sf, <span class="dv">1</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>primarysch.sf<span class="ot">&lt;-</span><span class="fu">select</span>(primarysch.sf, <span class="dv">1</span>)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf<span class="ot">&lt;-</span><span class="fu">select</span>(goodprimarysch.sf, <span class="dv">1</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">select</span>(mrt.sf, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-for-invalid-geometries" class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="check-for-invalid-geometries"><span class="header-section-number">3.4.2</span> <strong>Check for invalid geometries</strong></h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(eldercare.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(hawkercentre.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(childcare.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(kindergartens.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(parks.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(library.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(sport.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(busstop.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(shoppingmall.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(supermarket.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(primarysch.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(goodprimarysch.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mrt.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mpsz.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>We see that mpsz has 6 invalid geometries. Lets address them and check again</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>mpsz.sf <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(mpsz.sf)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mpsz.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="check-for-missing-values" class="level4" data-number="3.4.3">
<h4 data-number="3.4.3" class="anchored" data-anchor-id="check-for-missing-values"><span class="header-section-number">3.4.3</span> <strong>Check for missing values</strong></h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>eldercare.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(eldercare.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(hawkercentre.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>childcare.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(childcare.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>kindergartens.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(kindergartens.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 5 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] NAME     DESCRIP  ADDRESSP ADDRESSS ICON_NA  geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>parks.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(parks.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>library.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(library.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>sport.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(sport.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>busstop.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(busstop.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21
[1] BUS_STOP_N geometry  
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(shoppingmall.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] name     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>supermarket.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(supermarket.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21
[1] LIC_NAME geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>primarysch.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(primarysch.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] schl_nm  geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(goodprimarysch.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] schl_nm  geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>mrt.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(mrt.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
[1] Name     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
</section>
</section>
<section id="verifying-transforming-coordinate-system" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="verifying-transforming-coordinate-system"><span class="header-section-number">3.5</span> Verifying + Transforming Coordinate system</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Extracted</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Sourced</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mpsz.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 / Singapore TM 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(eldercare.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(hawkercentre.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(childcare.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(kindergartens.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(parks.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(library.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(sport.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(busstop.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS["SVY21",
    BASEGEOGCRS["WGS 84",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ID["EPSG",6326]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["Degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(shoppingmall.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(supermarket.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS["SVY21",
    BASEGEOGCRS["WGS 84",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ID["EPSG",6326]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["Degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(primarysch.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(goodprimarysch.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mrt.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
<p>Note: our projected CRS should be SVY21 (EPSG code 3414). However, some of the extracted data sets are in WGS84, and others are in SVY21 with the incorrect EPSG code (EPSG 9001)</p>
</div>
</div>
</div>
</section>
<section id="transforming-crs" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="transforming-crs"><span class="header-section-number">3.6</span> Transforming CRS</h3>
<p>With the invalid geometries found earlier, we use the functions st_set_crs() and st_transform() to correct them.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#st_set_crs() assigns proper EPSG code</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>busstop.sf<span class="ot">&lt;-</span><span class="fu">st_set_crs</span>(busstop.sf, <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for
that</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>supermarket.sf<span class="ot">&lt;-</span><span class="fu">st_set_crs</span>(supermarket.sf, <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for
that</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#st_transform() changes CRS from one to another</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>eldercare.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(eldercare.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(hawkercentre.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>childcare.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(childcare.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>kindergartens.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(kindergartens.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>parks.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(parks.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>library.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(library.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>sport.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(sport.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(shoppingmall.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>primarysch.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(primarysch.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(goodprimarysch.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(mrt.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="checking-crs" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="checking-crs"><span class="header-section-number">3.7</span> Checking crs</h3>
<p>Subsequently, we check again to make sure the data is in the proper CRS.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Extracted</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Sourced</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mpsz.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 / Singapore TM 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(eldercare.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(hawkercentre.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(childcare.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(kindergartens.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(parks.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(library.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(sport.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(busstop.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(shoppingmall.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(supermarket.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(primarysch.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(goodprimarysch.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mrt.sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS["SVY21 / Singapore TM",
    BASEGEOGCRS["SVY21",
        DATUM["SVY21",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4757]],
    CONVERSION["Singapore Transverse Mercator",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["northing (N)",north,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["easting (E)",east,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Cadastre, engineering survey, topographic mapping."],
        AREA["Singapore - onshore and offshore."],
        BBOX[1.13,103.59,1.47,104.07]],
    ID["EPSG",3414]]</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Everything looks fine! 🙃We are now done with wrangling our collected datasets!</p>
</section>
</section>
<section id="exploratory-data-analysis" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="exploratory-data-analysis"><span class="header-section-number">4</span> Exploratory Data Analysis</h2>
<p>Lets do a quick EDA for the data we collected!</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Transportation 🚃</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Education 📚</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Amenities 🚲</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#transport graph</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz.sf) <span class="sc">+</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(busstop.sf) <span class="sc">+</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mrt.sf) <span class="sc">+</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"green"</span>, <span class="at">alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Transportation"</span>,</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">frame =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co">#education</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz.sf) <span class="sc">+</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(primarysch.sf) <span class="sc">+</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"pink"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(goodprimarysch.sf) <span class="sc">+</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kindergartens.sf) <span class="sc">+</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(childcare.sf) <span class="sc">+</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"yellow"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Education"</span>,</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">frame =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ammenities</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz.sf) <span class="sc">+</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(parks.sf) <span class="sc">+</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"green"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hawkercentre.sf) <span class="sc">+</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"blue"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(library.sf) <span class="sc">+</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(sport.sf) <span class="sc">+</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"grey"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shoppingmall.sf) <span class="sc">+</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(supermarket.sf) <span class="sc">+</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"brown"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(eldercare.sf) <span class="sc">+</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"navy"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Ammenities"</span>,</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">frame =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-wrangling-1" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="data-wrangling-1"><span class="header-section-number">5</span> Data Wrangling</h2>
<section id="structural-factors" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="structural-factors"><span class="header-section-number">5.1</span> Structural Factors</h3>
<p>This includes the inherent structural factors of the flats, including Area, Floor Level and Lease Remaining years.</p>
<section id="floor-level---create-as-ordinal" class="level4" data-number="5.1.1">
<h4 data-number="5.1.1" class="anchored" data-anchor-id="floor-level---create-as-ordinal"><span class="header-section-number">5.1.1</span> Floor Level - create as ordinal</h4>
<p>To simplify analysis, we create the an ordinal column for the floor level variable. This code chunk matches the story levels to the list, and gives it an ordinal value based on its relative positioning in the list given (1 would be allocated to “01 TO 03”, 2 allocated to “04 TO 06”….).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the story levels and ordinal values </span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>story_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"01 TO 03"</span>, <span class="st">"04 TO 06"</span>, <span class="st">"07 TO 09"</span>, <span class="st">"10 TO 12"</span>, <span class="st">"13 TO 15"</span>, <span class="st">"16 TO 18"</span>, <span class="st">"19 TO 21"</span>, <span class="st">"22 TO 24"</span>, <span class="st">"25 TO 27"</span>, <span class="st">"28 TO 30"</span>, <span class="st">"31 TO 33"</span>, <span class="st">"34 TO 36"</span>, <span class="st">"37 TO 39"</span>, <span class="st">"40 TO 42"</span>, <span class="st">"43 TO 45"</span>, <span class="st">"46 TO 48"</span>, <span class="st">"49 TO 51"</span>) </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>story_ordinal <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(story_levels)  <span class="co"># Create the ordinal variable based on the story column </span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>Story_Ordinal <span class="ot">&lt;-</span> story_ordinal[<span class="fu">match</span>(resale<span class="sc">$</span>storey_range, story_levels)]  <span class="co"># Set the labels for the ordinal variable </span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(resale<span class="sc">$</span>Story_Ordinal) <span class="ot">&lt;-</span> story_levels</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lastly, we mutate the ordinal variable as a numeric</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>resale<span class="ot">&lt;-</span> resale <span class="sc">|&gt;</span> </span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Story_Ordinal=</span><span class="fu">as.numeric</span>(Story_Ordinal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remaining-lease---mutate-to-years" class="level4" data-number="5.1.2">
<h4 data-number="5.1.2" class="anchored" data-anchor-id="remaining-lease---mutate-to-years"><span class="header-section-number">5.1.2</span> Remaining lease - mutate to years</h4>
<p>The code chunk below seeks to convert the remaining lease period to in terms of years.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>str_list <span class="ot">&lt;-</span> <span class="fu">str_split</span>(resale<span class="sc">$</span>remaining_lease, <span class="st">" "</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(str_list)) {</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unlist</span>(str_list[i])) <span class="sc">&gt;</span> <span class="dv">2</span>) {</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>      year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>      month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">3</span>])</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>      resale<span class="sc">$</span>remaining_lease[i] <span class="ot">&lt;-</span> year <span class="sc">+</span> <span class="fu">round</span>(month<span class="sc">/</span><span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>    year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>    resale<span class="sc">$</span>remaining_lease[i] <span class="ot">&lt;-</span> year</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="locational-factors" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="locational-factors"><span class="header-section-number">5.2</span> Locational Factors</h3>
<p>This includes factors that concern location of amenities to the flat in question. For instance, Proximity to CBD or number of primary schools withi 350 m from the flat in question.</p>
<section id="cbd-location" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="cbd-location"><span class="header-section-number">5.2.1</span> CBD Location</h4>
<p>We need to factor in the proximity to CBD in the downtown core. As such let’s take the coordinates of Downtown Core to be the coordinates of the CBD</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fl">1.287953</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>lng <span class="ot">&lt;-</span> <span class="fl">103.851784</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>cbd.sf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lat, lng) <span class="sc">%&gt;%</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lng"</span>, <span class="st">"lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="proximity-distance-calculation" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="proximity-distance-calculation"><span class="header-section-number">5.2.2</span> Proximity Distance Calculation</h4>
<section id="converting-resale-df-into-sf-object" class="level5" data-number="5.2.2.1">
<h5 data-number="5.2.2.1" class="anchored" data-anchor-id="converting-resale-df-into-sf-object"><span class="header-section-number">5.2.2.1</span> Converting resale df into sf object</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(resale, </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, </span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"LATITUDE"</span>), </span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#afterwards, we transform it to SVY21, our desired CRS</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>One of the things we need to find is the proximity to particular facilities - which we can compute with st_distance(), and find the closest facility (shortest distance) with the rowMins() function of our matrixStats package. The values will be appended to the data frame as a new column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(units)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>proximity <span class="ot">&lt;-</span> <span class="cf">function</span>(df1, df2, varname) {</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(df1, df2) <span class="sc">|&gt;</span> </span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_units</span>()</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  df1[,varname] <span class="ot">&lt;-</span> <span class="fu">rowMins</span>(dist_matrix)</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df1)</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="implementation" class="level5" data-number="5.2.2.2">
<h5 data-number="5.2.2.2" class="anchored" data-anchor-id="implementation"><span class="header-section-number">5.2.2.2</span> Implementation</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, cbd.sf, <span class="st">"PROX_CBD"</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, eldercare.sf, <span class="st">"PROX_ELDERCARE"</span>)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, hawkercentre.sf, <span class="st">"PROX_HAWKERCENTRE"</span>)</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, childcare.sf, <span class="st">"PROX_CHILDCARE"</span>)</span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, kindergartens.sf, <span class="st">"PROX_KINDERGARTEN"</span>)</span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, parks.sf, <span class="st">"PROX_PARK"</span>)</span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, library.sf, <span class="st">"PROX_LIBRARY"</span>)</span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, sport.sf, <span class="st">"PROX_SPORT"</span>)</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, busstop.sf, <span class="st">"PROX_BUSSTOP"</span>)</span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, shoppingmall.sf, <span class="st">"PROX_SHOPPINGMALL"</span>)</span>
<span id="cb186-30"><a href="#cb186-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-31"><a href="#cb186-31" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-32"><a href="#cb186-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, supermarket.sf, <span class="st">"PROX_SUPERMARKET"</span>)</span>
<span id="cb186-33"><a href="#cb186-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-34"><a href="#cb186-34" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-35"><a href="#cb186-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, primarysch.sf, <span class="st">"PROX_PRIMARYSCH"</span>)</span>
<span id="cb186-36"><a href="#cb186-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-37"><a href="#cb186-37" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-38"><a href="#cb186-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, goodprimarysch.sf, <span class="st">"PROX_GOODPRIMARYSCH"</span>)</span>
<span id="cb186-39"><a href="#cb186-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-40"><a href="#cb186-40" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb186-41"><a href="#cb186-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, mrt.sf, <span class="st">"PROX_MRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="facility-count-within-radius-calculation" class="level4" data-number="5.2.3">
<h4 data-number="5.2.3" class="anchored" data-anchor-id="facility-count-within-radius-calculation"><span class="header-section-number">5.2.3</span> Facility Count within radius calculation</h4>
<p>Besides proximity, which calculates the shortest distance, we also want to find the number of facilities within a particular radius.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>num_radius <span class="ot">&lt;-</span> <span class="cf">function</span>(df1, df2, varname, radius) {</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(df1, df2) <span class="sc">%&gt;%</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_units</span>() <span class="sc">%&gt;%</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  df1[,varname] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dist_matrix <span class="sc">&lt;=</span> radius)</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df1)</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="implementation-1" class="level5" data-number="5.2.3.1">
<h5 data-number="5.2.3.1" class="anchored" data-anchor-id="implementation-1"><span class="header-section-number">5.2.3.1</span> Implementation</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, busstop.sf, <span class="st">"NUM_BUSSTOP"</span>, <span class="dv">350</span>)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, childcare.sf, <span class="st">"NUM_CHILDCARE"</span>, <span class="dv">350</span>)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, kindergartens.sf, <span class="st">"NUM_KINDERGARTEN"</span>, <span class="dv">350</span>)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, primarysch.sf, <span class="st">"NUM_PRIMARYSCH"</span>, <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="saving-resale.sf-as-a-rds-file" class="level4" data-number="5.2.4">
<h4 data-number="5.2.4" class="anchored" data-anchor-id="saving-resale.sf-as-a-rds-file"><span class="header-section-number">5.2.4</span> Saving Resale.sf as a rds file</h4>
<p>We are finally done with the inclusion of our prox and num variables 😫. We can now save our rds object into our model file for easy retrieval!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(resale.sf, <span class="st">"data/model/resale.sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reading-rds-file" class="level4" data-number="5.2.5">
<h4 data-number="5.2.5" class="anchored" data-anchor-id="reading-rds-file"><span class="header-section-number">5.2.5</span> Reading rds file</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>resale.sf<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/resale.sf.rds"</span>)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>resale.sf<span class="ot">&lt;-</span>resale.sf <span class="sc">|&gt;</span> </span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LEASE_YRS=</span><span class="fu">as.double</span>(LEASE_YRS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="regressions-1" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="regressions-1"><span class="header-section-number">6</span> Regressions</h2>
<p>With all our data prepared, we are now ready to look into regressing the data to create our prediction models! In particular, we explored the use of OLS, geographical weighted regression, random forest and geographical random forest in this section. 🌳🌲🌴</p>
<section id="data-preparation" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">6.1</span> Data Preparation</h3>
<section id="building-a-correlation-matrix" class="level4" data-number="6.1.1">
<h4 data-number="6.1.1" class="anchored" data-anchor-id="building-a-correlation-matrix"><span class="header-section-number">6.1.1</span> Building a correlation matrix</h4>
<p>In order to avoid issues of multicollinearity in regression models, we first visualise our data using a correlation matrix.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>resale_nogeo <span class="ot">&lt;-</span> resale.sf <span class="sc">|&gt;</span> </span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span> </span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>PRICE)</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="fu">cor</span>(resale_nogeo), </span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag =</span> <span class="cn">FALSE</span>, </span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">order =</span> <span class="st">"AOE"</span>,</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.pos =</span> <span class="st">"td"</span>, </span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.cex =</span> <span class="fl">0.5</span>, </span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"number"</span>, </span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">"upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We realise that the variables “lease_commence_date” which is the beginning year of lease, and “LEASE_YRS” which is the number of years left in the lease, are perfectly collinear with a correlation coeffecient of 1. We choose to drop “lease_commence_date” to avoid the problem of perfect collinearity. This creates our final resale df (“resale_final”).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>resale_final <span class="ot">&lt;-</span> resale.sf <span class="sc">|&gt;</span> </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lease_commence_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="splitting-data-into-test-and-training-set" class="level4" data-number="6.1.2">
<h4 data-number="6.1.2" class="anchored" data-anchor-id="splitting-data-into-test-and-training-set"><span class="header-section-number">6.1.2</span> Splitting data into test and training set</h4>
<p>From the assignment brief, our training data consists of transactions that occurred from 1st January 2021 to 31st December 2022, while test data occurred from January and February 2023.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>train_data<span class="ot">&lt;-</span>resale_final <span class="sc">|&gt;</span> </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2021-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2022-12"</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>test_data<span class="ot">&lt;-</span>resale_final <span class="sc">|&gt;</span> </span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2023-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2023-02"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="building-a-non-spatial-multiple-linear-regression" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="building-a-non-spatial-multiple-linear-regression"><span class="header-section-number">6.2</span> Building a non spatial multiple linear regression</h3>
<p>First we explored the creation of an OLS model in the code chunk below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>price_mlr<span class="ot">&lt;-</span> <span class="fu">lm</span>(PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH, <span class="at">data=</span>train_data)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="co">#removed flat type given that we only consider 4 room flats</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="co">#remove geographical variables given GWR</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">#removed month &lt;- questionable interpretability of coefficient (if generated)</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(price_mlr)</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(price_mlr, <span class="st">"data/model/price_mlr.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can read the output below</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>price_mlr_summary<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/price_mlr.rds"</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>price_mlr_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PRICE ~ Story_Ordinal + LEASE_YRS + AREA_SQM + PROX_CBD + 
    PROX_ELDERCARE + PROX_HAWKERCENTRE + PROX_PARK + PROX_LIBRARY + 
    PROX_SPORT + PROX_BUSSTOP + PROX_SHOPPINGMALL + PROX_SUPERMARKET + 
    PROX_GOODPRIMARYSCH + PROX_MRT + NUM_CHILDCARE + NUM_KINDERGARTEN + 
    NUM_PRIMARYSCH, data = train_data)

Coefficients:
        (Intercept)        Story_Ordinal            LEASE_YRS  
          8.701e+04            1.606e+04            4.435e+03  
           AREA_SQM             PROX_CBD       PROX_ELDERCARE  
          3.552e+03           -1.631e+01           -8.064e+00  
  PROX_HAWKERCENTRE            PROX_PARK         PROX_LIBRARY  
         -2.115e+01            6.458e+00           -2.693e+01  
         PROX_SPORT         PROX_BUSSTOP    PROX_SHOPPINGMALL  
          2.054e+00           -1.732e+01           -1.261e+01  
   PROX_SUPERMARKET  PROX_GOODPRIMARYSCH             PROX_MRT  
          1.088e+01           -3.043e-01           -1.519e+01  
      NUM_CHILDCARE     NUM_KINDERGARTEN       NUM_PRIMARYSCH  
         -2.821e+03            7.866e+03           -1.098e+04  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a more elegant way of visualising the summary table can be done through using the gtsummary package!</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>price_mlr<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/price_mlr.rds"</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(price_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="bhmjdnddps" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#bhmjdnddps) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#bhmjdnddps) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#bhmjdnddps) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#bhmjdnddps) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#bhmjdnddps) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#bhmjdnddps) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#bhmjdnddps) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#bhmjdnddps) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#bhmjdnddps) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#bhmjdnddps) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#bhmjdnddps) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#bhmjdnddps) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#bhmjdnddps) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#bhmjdnddps) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#bhmjdnddps) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#bhmjdnddps) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#bhmjdnddps) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#bhmjdnddps) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#bhmjdnddps) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#bhmjdnddps) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#bhmjdnddps) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#bhmjdnddps) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#bhmjdnddps) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#bhmjdnddps) .gt_left {
  text-align: left;
}

:where(#bhmjdnddps) .gt_center {
  text-align: center;
}

:where(#bhmjdnddps) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#bhmjdnddps) .gt_font_normal {
  font-weight: normal;
}

:where(#bhmjdnddps) .gt_font_bold {
  font-weight: bold;
}

:where(#bhmjdnddps) .gt_font_italic {
  font-style: italic;
}

:where(#bhmjdnddps) .gt_super {
  font-size: 65%;
}

:where(#bhmjdnddps) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#bhmjdnddps) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#bhmjdnddps) .gt_indent_1 {
  text-indent: 5px;
}

:where(#bhmjdnddps) .gt_indent_2 {
  text-indent: 10px;
}

:where(#bhmjdnddps) .gt_indent_3 {
  text-indent: 15px;
}

:where(#bhmjdnddps) .gt_indent_4 {
  text-indent: 20px;
}

:where(#bhmjdnddps) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Beta</strong>"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><sup class=&quot;gt_footnote_marks&quot;>1</sup>"><strong>95% CI</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">Story_Ordinal</td>
<td headers="estimate" class="gt_row gt_center">16,063</td>
<td headers="ci" class="gt_row gt_center">15,624, 16,502</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">LEASE_YRS</td>
<td headers="estimate" class="gt_row gt_center">4,435</td>
<td headers="ci" class="gt_row gt_center">4,359, 4,510</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">AREA_SQM</td>
<td headers="estimate" class="gt_row gt_center">3,552</td>
<td headers="ci" class="gt_row gt_center">3,417, 3,688</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_CBD</td>
<td headers="estimate" class="gt_row gt_center">-16</td>
<td headers="ci" class="gt_row gt_center">-17, -16</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_ELDERCARE</td>
<td headers="estimate" class="gt_row gt_center">-8.1</td>
<td headers="ci" class="gt_row gt_center">-9.8, -6.4</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_HAWKERCENTRE</td>
<td headers="estimate" class="gt_row gt_center">-21</td>
<td headers="ci" class="gt_row gt_center">-23, -19</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_PARK</td>
<td headers="estimate" class="gt_row gt_center">6.5</td>
<td headers="ci" class="gt_row gt_center">4.2, 8.7</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_LIBRARY</td>
<td headers="estimate" class="gt_row gt_center">-27</td>
<td headers="ci" class="gt_row gt_center">-29, -25</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_SPORT</td>
<td headers="estimate" class="gt_row gt_center">2.1</td>
<td headers="ci" class="gt_row gt_center">0.67, 3.4</td>
<td headers="p.value" class="gt_row gt_center">0.004</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_BUSSTOP</td>
<td headers="estimate" class="gt_row gt_center">-17</td>
<td headers="ci" class="gt_row gt_center">-33, -1.5</td>
<td headers="p.value" class="gt_row gt_center">0.031</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_SHOPPINGMALL</td>
<td headers="estimate" class="gt_row gt_center">-13</td>
<td headers="ci" class="gt_row gt_center">-15, -9.9</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_SUPERMARKET</td>
<td headers="estimate" class="gt_row gt_center">11</td>
<td headers="ci" class="gt_row gt_center">4.8, 17</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_GOODPRIMARYSCH</td>
<td headers="estimate" class="gt_row gt_center">-0.30</td>
<td headers="ci" class="gt_row gt_center">-0.69, 0.08</td>
<td headers="p.value" class="gt_row gt_center">0.12</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_MRT</td>
<td headers="estimate" class="gt_row gt_center">-15</td>
<td headers="ci" class="gt_row gt_center">-18, -13</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_CHILDCARE</td>
<td headers="estimate" class="gt_row gt_center">-2,821</td>
<td headers="ci" class="gt_row gt_center">-3,295, -2,348</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_KINDERGARTEN</td>
<td headers="estimate" class="gt_row gt_center">7,866</td>
<td headers="ci" class="gt_row gt_center">6,864, 8,869</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_PRIMARYSCH</td>
<td headers="estimate" class="gt_row gt_center">-10,982</td>
<td headers="ci" class="gt_row gt_center">-11,670, -10,294</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</section>
<section id="gwr-predictive-method" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="gwr-predictive-method"><span class="header-section-number">6.3</span> GWR predictive method</h3>
<p>gwr method will be used to calibrate a model to predict the HDB resale prices.</p>
<p>We first need to convert the sf data.frame to a SpatialPointDataFrame</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>train_data_sp<span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">as_Spatial</span>(train_data)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>train_data_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 23656 
extent      : 11519.79, 42645.18, 28217.39, 48741.06  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 29
names       :   PRICE,   month,       town, flat_type, block,   street_name, storey_range, AREA_SQM,    flat_model, LEASE_YRS, Story_Ordinal,         PROX_CBD,      PROX_ELDERCARE, PROX_HAWKERCENTRE,      PROX_CHILDCARE, ... 
min values  :  250000, 2021-01, ANG MO KIO,    4 ROOM,     1,  ADMIRALTY DR,     01 TO 03,       70, Adjoined flat,      44.5,             1, 999.393538715878, 1.9938461723793e-05,  30.6031805185926, 1.4128908036435e-05, ... 
max values  : 1370000, 2022-12,     YISHUN,    4 ROOM,    9B, YUNG SHENG RD,     49 TO 51,      145,       Type S1,     97.33,            17, 19650.0691667807,    3301.63731683139,  2867.63031236184,    547.386819517238, ... </code></pre>
</div>
</div>
<section id="computing-adaptive-bandwidth" class="level4" data-number="6.3.1">
<h4 data-number="6.3.1" class="anchored" data-anchor-id="computing-adaptive-bandwidth"><span class="header-section-number">6.3.1</span> Computing adaptive bandwidth</h4>
<p>Next, bw.gwr() of GWmodel package will be used to determine the optimal bandwidth to be used.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH,</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>train_data_sp,</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">longlat=</span><span class="cn">FALSE</span>)</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_adaptive, <span class="st">"data/model/bw_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code below can be used to display the model output.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/bw_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="constructing-gwr-model" class="level4" data-number="6.3.2">
<h4 data-number="6.3.2" class="anchored" data-anchor-id="constructing-gwr-model"><span class="header-section-number">6.3.2</span> Constructing gwr model</h4>
<p>Forming model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH,</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data=</span>train_data_sp,</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw=</span>bw_adaptive, </span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_adaptive, <span class="st">"data/model/gwr_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code below can be used to display the model output.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/gwr_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="preparing-coordinates-data" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="preparing-coordinates-data"><span class="header-section-number">6.4</span> Preparing coordinates data</h3>
<section id="extracting-coordinates-data" class="level4" data-number="6.4.1">
<h4 data-number="6.4.1" class="anchored" data-anchor-id="extracting-coordinates-data"><span class="header-section-number">6.4.1</span> Extracting coordinates data</h4>
<p>The code chunk below extracts the x, y coordinates of the full training and test data sets.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>coords<span class="ot">&lt;-</span><span class="fu">st_coordinates</span>(resale_final)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>coords_train<span class="ot">&lt;-</span><span class="fu">st_coordinates</span>(train_data)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>coords_test<span class="ot">&lt;-</span><span class="fu">st_coordinates</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Save into rds</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(coords_train, <span class="st">"data/model/coords_train.rds"</span>)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(coords_test, <span class="st">"data/model/coords_test.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Read RDS</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>coords_train<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/coords_train.rds"</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>coords_test<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/coords_test.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="dropping-geometry-field" class="level4" data-number="6.4.2">
<h4 data-number="6.4.2" class="anchored" data-anchor-id="dropping-geometry-field"><span class="header-section-number">6.4.2</span> Dropping geometry field</h4>
<p>Drop geometry column of the sf dataframe by using st_drop_geometry()</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>train_data<span class="ot">&lt;-</span>train_data <span class="sc">|&gt;</span> </span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(train_data, <span class="st">"data/model/train_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Read RDS</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>train_data<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/train_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="calibrating-random-forest-model" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="calibrating-random-forest-model"><span class="header-section-number">6.5</span> Calibrating Random Forest Model</h3>
<p>In this section, we will to calibrate a model to predict HDB resale price by using random forest function of ranger package. 🌳🌲🌴🌳🌲🌴</p>
<section id="forming-model" class="level4" data-number="6.5.1">
<h4 data-number="6.5.1" class="anchored" data-anchor-id="forming-model"><span class="header-section-number">6.5.1</span> forming model</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) </span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>rf<span class="ot">&lt;-</span> <span class="fu">ranger</span>(PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH, <span class="at">data=</span>train_data)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rf)</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rf, <span class="st">"data/model/rf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>read RDS object</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>rf<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/rf.rds"</span>)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(PRICE ~ Story_Ordinal + LEASE_YRS + AREA_SQM + PROX_CBD +      PROX_ELDERCARE + PROX_HAWKERCENTRE + PROX_PARK + PROX_LIBRARY +      PROX_SPORT + PROX_BUSSTOP + PROX_SHOPPINGMALL + PROX_SUPERMARKET +      PROX_GOODPRIMARYSCH + PROX_MRT + NUM_CHILDCARE + NUM_KINDERGARTEN +      NUM_PRIMARYSCH, data = train_data) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      23656 
Number of independent variables:  17 
Mtry:                             4 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       1051737948 
R squared (OOB):                  0.9372898 </code></pre>
</div>
</div>
</section>
</section>
<section id="calibrating-geographic-random-forest-using-grf" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="calibrating-geographic-random-forest-using-grf"><span class="header-section-number">6.6</span> Calibrating Geographic random forest using grf</h3>
<section id="computing-bandwidth-for-grf" class="level4" data-number="6.6.1">
<h4 data-number="6.6.1" class="anchored" data-anchor-id="computing-bandwidth-for-grf"><span class="header-section-number">6.6.1</span> Computing bandwidth for grf</h4>
<p>Minimise trees to trees=50 for ease of computation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determining bandwidth for model</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>bw_grf_adaptive<span class="ot">&lt;-</span><span class="fu">grf.bw</span>(<span class="at">formula =</span> PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH, <span class="at">dataset =</span> train_data, <span class="at">kernel =</span> <span class="st">"adaptive"</span>, <span class="at">coords =</span> coords_train, <span class="at">trees=</span><span class="dv">50</span>)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_grf_adaptive, <span class="st">"data/model/bw_grf_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>we were unable to gain the bandwidth result even after extensive waiting. For the assignment requirements, we will consider the bandwidths generated and choose the one that gives the highest R2 value. The output generated can be seen in the screenshots attached:</p>
<p><img src="images/photo_2023-03-22_20-54-38.jpg" class="img-fluid"></p>
<p><img src="images/photo_2023-03-22_20-54-42.jpg" class="img-fluid"></p>
<p>From our data gathered, we find that the optimal bandwidth within the bandwidths calculated is when bandwidth = 1211. We then assign this to the bw_grf_adaptive object</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>bw_grf_adaptive<span class="ot">&lt;-</span><span class="dv">1211</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="generating-model" class="level4" data-number="6.6.2">
<h4 data-number="6.6.2" class="anchored" data-anchor-id="generating-model"><span class="header-section-number">6.6.2</span> Generating model</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive<span class="ot">&lt;-</span><span class="fu">grf</span>(<span class="at">formula =</span> PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH,</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dframe=</span>train_data,</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bw=</span>bw_grf_adaptive, <span class="co"># need to know how to calculate using function</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coords=</span>coords_train,</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ntree=</span><span class="dv">50</span>)</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive, <span class="st">"data/model/gwRF_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The output rds file generated is 31.7GB, which is larger than what is recommended to push into Git. Therefore, we append screenshots of our outputs instead. 🌳🌲🌴🌳🌲🌴</p>
<p><img src="images/image_2023-03-24_08-35-58.png" class="img-fluid"><img src="images/image_2023-03-24_09-03-48.png" class="img-fluid"><img src="images/photo_2023-03-24_11-26-06.jpg" class="img-fluid"><img src="images/photo_2023-03-24_11-26-09.jpg" class="img-fluid"></p>
</section>
</section>
</section>
<section id="predictions" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="predictions"><span class="header-section-number">7</span> Predictions</h2>
<section id="preparing-the-test-data" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="preparing-the-test-data"><span class="header-section-number">7.1</span> Preparing the test data</h3>
<p>The code chunk below will be used to combine the test data with the corresponding coordinates data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, coords_test) <span class="sc">%&gt;%</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data, <span class="st">"data/model/test_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="predicting-with-test-data" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="predicting-with-test-data"><span class="header-section-number">7.2</span> Predicting with test data</h3>
<p>Next, predict.grf() of spatialML package will be used to predict the resale value by using the test data and gwRF_adaptive model calibrated earlier.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>gwRF_pred <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive, </span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>                           test_data, </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y.var.name=</span><span class="st">"Y"</span>, </span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(gwRF_pred, <span class="st">"data/model/GRF_pred.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="converting-the-prediction-output-into-a-dataframe" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="converting-the-prediction-output-into-a-dataframe"><span class="header-section-number">7.3</span> Converting the prediction output into a dataframe</h3>
<p>The output of the predict.grf() is a vector of predicted values. It is wiser to convert it into a data frame for further visualisation and analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/GRF_pred.rds"</span>)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>GRF_pred_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(GRF_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below, cbind() is used to append the predicted values onto test_data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, GRF_pred_df)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co">#save this as an rds object</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_p, <span class="st">"data/model/test_data_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculating-root-mean-square-error" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="calculating-root-mean-square-error"><span class="header-section-number">7.4</span> Calculating Root Mean Square Error</h3>
<p>The root mean square error (RMSE) allows us to measure how far predicted values are from observed values in a regression analysis. In the code chunk below, rmse() of Metrics package is used to compute the RMSE.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>Metrics<span class="sc">::</span><span class="fu">rmse</span>(test_data_p<span class="sc">$</span>PRICE, </span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>     test_data_p<span class="sc">$</span>GRF_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44545.08</code></pre>
</div>
</div>
</section>
<section id="visualising-the-predicted-values" class="level3" data-number="7.5">
<h3 data-number="7.5" class="anchored" data-anchor-id="visualising-the-predicted-values"><span class="header-section-number">7.5</span> Visualising the predicted values</h3>
<p>Alternatively, scatterplot can be used to visualise the actual resale price and the predicted resale price by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="conclusions-comparisons" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="conclusions-comparisons"><span class="header-section-number">8</span> Conclusions: Comparisons</h2>
<p>In the last objective of this take home assignment, a comparison between the conventional OLS method versus the geographically weighted methods should be done.</p>
<p>As this task is focused on predictive modelling, a comparison between the OLS method (a method predominantly for explanatory models) and geographical random forest (for predictive modelling with geographical elements).</p>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 35%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>OLS</th>
<th>Geographical random forest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Main purpose</td>
<td>Explanatory model for standard regressions</td>
<td>Predictive model for regressions with geographical elements</td>
</tr>
<tr class="even">
<td>Seeks to minimise</td>
<td>residual sum of squares</td>
<td>mean squared error</td>
</tr>
</tbody>
</table>
<p>With a basic understanding of how each model works, we hypothesise that the gwRF model will be the most appropriate for analysis, as it accounts for geographical elements included in the resale flat data, as well as the predictive aspect of this model.</p>
<p>To estimate the predictive power of each of the models, we plot each of the predicted values against actual prices in the test data set, and calculate the root MSEs for each of the models.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">OLS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Geographical Random Forest</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>price_mlr<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/price_mlr.rds"</span>)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>mlr_pred_df<span class="ot">&lt;-</span><span class="fu">predict</span>(price_mlr, test_data)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>test_data_mlr <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, mlr_pred_df)</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>Metrics<span class="sc">::</span><span class="fu">rmse</span>(test_data_mlr<span class="sc">$</span>PRICE, </span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>     test_data_mlr<span class="sc">$</span>mlr_pred_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 83524.62</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_mlr,</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> mlr_pred_df,</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co">#detailed code chunks can be found in earlier sections</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>Metrics<span class="sc">::</span><span class="fu">rmse</span>(test_data_p<span class="sc">$</span>PRICE, </span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>     test_data_p<span class="sc">$</span>GRF_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44545.08</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>From this comparisons, we conclude that the predictive power of geographical weighted random forest was the most powerful to predict resale prices. this affirms our hypothesis that geographical weighted random forest models are the most appropriate for modelling resale flat data. 🌳🌲🌴</p>
<p>However, our analysis in this assignment was limited🙁:</p>
<ol type="1">
<li>A key flaw was the limited number of trees we used in each forest generated in the gwRF model. Due to limited capacity of our devices, we set ntree = 50 instead of a higher value. A more comprehensive model could have been created with a stronger device that has greater computational power.</li>
</ol>
</section>
<section id="references" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="references"><span class="header-section-number">9</span> References</h2>
<p>In the course of this assignment, reference was taken from our senior Megans work. Check out her website here 🤗: <a href="https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/" class="uri">https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/</a></p>
<p>We also referenced Prof Kam’s in class exercise 9 in this assignment: <a href="https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex09/in-class_ex09_gwml" class="uri">https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex09/in-class_ex09_gwml</a></p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb228" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Exercise 3: Predicting HDB Public Housing Resale Pricies using Geographically Weighted Methods"</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "11 March 2023"</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Task</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a>Pandemic-induced supply chain constraints coinciding with the booming demand for flats have driven HDB resale prices up by 10.3% in 2022. For young couples deciding to buy a home to stay in, it seems nearly impossible to do so especially with the exorbitantly high price tags attached to flats recently.</span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a>This has caused many to think about what are the factors that affect the prices of HDB resale flats-- some of which may be geographical in nature. For instance, some may pioritise of living near the local MRT, while others may focus on the location of schools within the vicinity of a flat.</span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a>In this take-home exercise, we will build a predictive model for the month of January and February 2023 in Singapore. The predictive models must be built by using by using conventional OLS method and GWR methods. Lastly, we will compare the performance of the conventional OLS method versus the geographical weighted methods.</span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-21"><a href="#cb228-21" aria-hidden="true" tabindex="-1"></a>The assignment submission is split into the following sections</span>
<span id="cb228-22"><a href="#cb228-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-23"><a href="#cb228-23" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span><span class="co">[</span><span class="ot">Installing packages</span><span class="co">]</span></span>
<span id="cb228-24"><a href="#cb228-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-25"><a href="#cb228-25" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span><span class="co">[</span><span class="ot">Data Collection</span><span class="co">](#data-collection-1)</span></span>
<span id="cb228-26"><a href="#cb228-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-27"><a href="#cb228-27" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span><span class="co">[</span><span class="ot">Exploratory Data Analysis</span><span class="co">]</span></span>
<span id="cb228-28"><a href="#cb228-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-29"><a href="#cb228-29" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span><span class="co">[</span><span class="ot">Data Wrangling</span><span class="co">](#data-wrangling-1)</span></span>
<span id="cb228-30"><a href="#cb228-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-31"><a href="#cb228-31" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span><span class="co">[</span><span class="ot">Regressions</span><span class="co">](#regressions-1)</span></span>
<span id="cb228-32"><a href="#cb228-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-33"><a href="#cb228-33" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span><span class="co">[</span><span class="ot">Predictions</span><span class="co">]</span></span>
<span id="cb228-34"><a href="#cb228-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-35"><a href="#cb228-35" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span><span class="co">[</span><span class="ot">References</span><span class="co">]</span></span>
<span id="cb228-36"><a href="#cb228-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-37"><a href="#cb228-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Installing packages</span></span>
<span id="cb228-38"><a href="#cb228-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-41"><a href="#cb228-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-42"><a href="#cb228-42" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary, sfdep, onemapsgapi, stringr, SpatialML, devtools, tidymodels, kableExtra)</span>
<span id="cb228-43"><a href="#cb228-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-44"><a href="#cb228-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-45"><a href="#cb228-45" aria-hidden="true" tabindex="-1"></a>The uses of each package installed can be found below:</span>
<span id="cb228-46"><a href="#cb228-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-47"><a href="#cb228-47" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb228-48"><a href="#cb228-48" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Collection</span></span>
<span id="cb228-49"><a href="#cb228-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-50"><a href="#cb228-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>kableExtra: an extension of kable, used for table customisation</span>
<span id="cb228-51"><a href="#cb228-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-52"><a href="#cb228-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>onemapsgapi: used to query Singapore-specifif spatial data, alongside additional functionalities</span>
<span id="cb228-53"><a href="#cb228-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-54"><a href="#cb228-54" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>httr: used to make API calls, such as GET requests</span>
<span id="cb228-55"><a href="#cb228-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-56"><a href="#cb228-56" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Wrangling</span></span>
<span id="cb228-57"><a href="#cb228-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-58"><a href="#cb228-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>sf: used for importing, managing and processing geospatial data</span>
<span id="cb228-59"><a href="#cb228-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-60"><a href="#cb228-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>spdep: used to create spatial weight matrix objects, global and local spatial autocorrelation statistics and related calculations</span>
<span id="cb228-61"><a href="#cb228-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-62"><a href="#cb228-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>sfdep: builds on spdep to create sn sf and tidyverse friendly interface to the package</span>
<span id="cb228-63"><a href="#cb228-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-64"><a href="#cb228-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>tidyverse: collection of R packages designed for data wrangling</span>
<span id="cb228-65"><a href="#cb228-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-66"><a href="#cb228-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>stringr: provides a cohesive set of functions designed to make working with strings easily</span>
<span id="cb228-67"><a href="#cb228-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-68"><a href="#cb228-68" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Visualisation</span></span>
<span id="cb228-69"><a href="#cb228-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-70"><a href="#cb228-70" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>tmap: used for creating thematic maps, such as chloropleth and bubble maps</span>
<span id="cb228-71"><a href="#cb228-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-72"><a href="#cb228-72" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regressions</span></span>
<span id="cb228-73"><a href="#cb228-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-74"><a href="#cb228-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>olsrr: used for building least square regression models</span>
<span id="cb228-75"><a href="#cb228-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-76"><a href="#cb228-76" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>corrplot + ggpubr: Used for multivariate data visualisation and analysis</span>
<span id="cb228-77"><a href="#cb228-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-78"><a href="#cb228-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GWmodel: provides a collection of localised spatial statistical methods such as summary statistic, principal components analysis, discriminant analysis and various forms of GW regression</span>
<span id="cb228-79"><a href="#cb228-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-80"><a href="#cb228-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>gtsummary: provides an elegant and flexible way to create publication-ready analytical and summary tables using the **R** programming language</span>
<span id="cb228-81"><a href="#cb228-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-82"><a href="#cb228-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>devtools: used for installing any R packages which is not available in RCRAN</span>
<span id="cb228-83"><a href="#cb228-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-84"><a href="#cb228-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SpatialML: allows for a geographically weighted random forest regression to include a function to find the optimal bandwidth</span>
<span id="cb228-85"><a href="#cb228-85" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb228-86"><a href="#cb228-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-87"><a href="#cb228-87" aria-hidden="true" tabindex="-1"></a><span class="fu">### OneMapAPI: usage</span></span>
<span id="cb228-88"><a href="#cb228-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-89"><a href="#cb228-89" aria-hidden="true" tabindex="-1"></a>In this exercise, the collection of the coordinate data of singapore-specific places can tap on the database implemented by <span class="co">[</span><span class="ot">OneMapSg</span><span class="co">](https://www.onemap.gov.sg/main/v2/)</span>. 🏠</span>
<span id="cb228-90"><a href="#cb228-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-91"><a href="#cb228-91" aria-hidden="true" tabindex="-1"></a>Referencing one of our senior <span class="co">[</span><span class="ot">Megan's</span><span class="co">](https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/)</span> work, the steps to intialise this processes is as follows:</span>
<span id="cb228-92"><a href="#cb228-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-93"><a href="#cb228-93" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Make sure you have your token value after signing up for a OneMapSG account</span>
<span id="cb228-94"><a href="#cb228-94" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Search for the specified theme with search_themes(token, "searchval").</span>
<span id="cb228-95"><a href="#cb228-95" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Check the theme status with get_theme_status(token, "themename")</span>
<span id="cb228-96"><a href="#cb228-96" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>From here, we can convert our tibble dataframe to simple features dataframe. All the themes for this project use Lat and Lng as the latitude and longitude respectively, and our project coordinates system should be in the WGS84 system, aka ESPG code 4326. Thus, <span class="in">`themesf &lt;- st_as_sf(themetibble, coords=c("Lng", "Lat"), crs=4326)`</span></span>
<span id="cb228-97"><a href="#cb228-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-98"><a href="#cb228-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-99"><a href="#cb228-99" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb228-100"><a href="#cb228-100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(onemapsgapi)</span>
<span id="cb228-101"><a href="#cb228-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-102"><a href="#cb228-102" aria-hidden="true" tabindex="-1"></a>token <span class="ot">&lt;-</span> <span class="st">"your value"</span></span>
<span id="cb228-103"><a href="#cb228-103" aria-hidden="true" tabindex="-1"></a><span class="fu">search_themes</span>(token, <span class="st">"searchval"</span>)</span>
<span id="cb228-104"><a href="#cb228-104" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme_status</span>(token, <span class="st">"themename"</span>)</span>
<span id="cb228-105"><a href="#cb228-105" aria-hidden="true" tabindex="-1"></a>themetibble <span class="ot">&lt;-</span> <span class="fu">get_theme</span>(token, <span class="st">"themename"</span>)</span>
<span id="cb228-106"><a href="#cb228-106" aria-hidden="true" tabindex="-1"></a>themesf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(themetibble, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-107"><a href="#cb228-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-108"><a href="#cb228-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-109"><a href="#cb228-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb228-110"><a href="#cb228-110" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(onemapsgapi)</span>
<span id="cb228-111"><a href="#cb228-111" aria-hidden="true" tabindex="-1"></a>token <span class="ot">&lt;-</span> <span class="fu">get_token</span>(<span class="st">"pengyouyun@gmail.com"</span>, <span class="st">"Learning@2015"</span>)</span>
<span id="cb228-112"><a href="#cb228-112" aria-hidden="true" tabindex="-1"></a>childcare<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"childcare"</span>)</span>
<span id="cb228-113"><a href="#cb228-113" aria-hidden="true" tabindex="-1"></a>themes<span class="ot">&lt;-</span><span class="fu">search_themes</span>(token)</span>
<span id="cb228-114"><a href="#cb228-114" aria-hidden="true" tabindex="-1"></a>themes</span>
<span id="cb228-115"><a href="#cb228-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-116"><a href="#cb228-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-117"><a href="#cb228-117" aria-hidden="true" tabindex="-1"></a>With that in mind, lets move on to data collection! 🙃</span>
<span id="cb228-118"><a href="#cb228-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-119"><a href="#cb228-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Collection {#data-collection-1}</span></span>
<span id="cb228-120"><a href="#cb228-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-121"><a href="#cb228-121" aria-hidden="true" tabindex="-1"></a>The following data would be used for the formation of our regression</span>
<span id="cb228-122"><a href="#cb228-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-125"><a href="#cb228-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-126"><a href="#cb228-126" aria-hidden="true" tabindex="-1"></a><span class="co"># initialise a dataframe of our aspatial and geospatial dataset details</span></span>
<span id="cb228-127"><a href="#cb228-127" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb228-128"><a href="#cb228-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type=</span><span class="fu">c</span>(<span class="st">"Aspatial"</span>,</span>
<span id="cb228-129"><a href="#cb228-129" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial"</span>,</span>
<span id="cb228-130"><a href="#cb228-130" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb228-131"><a href="#cb228-131" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb228-132"><a href="#cb228-132" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb228-133"><a href="#cb228-133" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb228-134"><a href="#cb228-134" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb228-135"><a href="#cb228-135" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb228-136"><a href="#cb228-136" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb228-137"><a href="#cb228-137" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Extracted"</span>,</span>
<span id="cb228-138"><a href="#cb228-138" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb228-139"><a href="#cb228-139" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb228-140"><a href="#cb228-140" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb228-141"><a href="#cb228-141" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb228-142"><a href="#cb228-142" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>,</span>
<span id="cb228-143"><a href="#cb228-143" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Selfsourced"</span>),</span>
<span id="cb228-144"><a href="#cb228-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-145"><a href="#cb228-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(<span class="st">"Resale Flat Prices"</span>,</span>
<span id="cb228-146"><a href="#cb228-146" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Master Plan 2019 Subzone Boundary (Web)"</span>,</span>
<span id="cb228-147"><a href="#cb228-147" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb228-148"><a href="#cb228-148" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Childcare Services"</span>,</span>
<span id="cb228-149"><a href="#cb228-149" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Eldercare Services"</span>,</span>
<span id="cb228-150"><a href="#cb228-150" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Hawker Centres"</span>,</span>
<span id="cb228-151"><a href="#cb228-151" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Kindergartens"</span>,</span>
<span id="cb228-152"><a href="#cb228-152" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Parks"</span>,</span>
<span id="cb228-153"><a href="#cb228-153" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Libraries"</span>,</span>
<span id="cb228-154"><a href="#cb228-154" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sport Facilities"</span>,</span>
<span id="cb228-155"><a href="#cb228-155" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb228-156"><a href="#cb228-156" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Bus Stop Locations Aug 2021"</span>,</span>
<span id="cb228-157"><a href="#cb228-157" aria-hidden="true" tabindex="-1"></a>         <span class="st">"MRT &amp; LRT Locations Aug 2021"</span>,</span>
<span id="cb228-158"><a href="#cb228-158" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Supermarkets"</span>,</span>
<span id="cb228-159"><a href="#cb228-159" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Shopping Mall SVY21 Coordinates"</span>, </span>
<span id="cb228-160"><a href="#cb228-160" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Primary School"</span>),</span>
<span id="cb228-161"><a href="#cb228-161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-162"><a href="#cb228-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">Format=</span><span class="fu">c</span>(<span class="st">".csv"</span>, </span>
<span id="cb228-163"><a href="#cb228-163" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb228-164"><a href="#cb228-164" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb228-165"><a href="#cb228-165" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb228-166"><a href="#cb228-166" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb228-167"><a href="#cb228-167" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb228-168"><a href="#cb228-168" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb228-169"><a href="#cb228-169" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb228-170"><a href="#cb228-170" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb228-171"><a href="#cb228-171" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb228-172"><a href="#cb228-172" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb228-173"><a href="#cb228-173" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb228-174"><a href="#cb228-174" aria-hidden="true" tabindex="-1"></a>           <span class="st">".kml"</span>,</span>
<span id="cb228-175"><a href="#cb228-175" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb228-176"><a href="#cb228-176" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb228-177"><a href="#cb228-177" aria-hidden="true" tabindex="-1"></a>           <span class="st">".csv"</span>),</span>
<span id="cb228-178"><a href="#cb228-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-179"><a href="#cb228-179" aria-hidden="true" tabindex="-1"></a>  <span class="at">Source=</span><span class="fu">c</span>(<span class="st">"[data.gov.sg](https://data.gov.sg/dataset/resale-flat-prices)"</span>,</span>
<span id="cb228-180"><a href="#cb228-180" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[data.gov.sg](https://data.gov.sg/dataset/master-plan-2014-subzone-boundary-web)"</span>,</span>
<span id="cb228-181"><a href="#cb228-181" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb228-182"><a href="#cb228-182" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb228-183"><a href="#cb228-183" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb228-184"><a href="#cb228-184" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb228-185"><a href="#cb228-185" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb228-186"><a href="#cb228-186" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb228-187"><a href="#cb228-187" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb228-188"><a href="#cb228-188" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb228-189"><a href="#cb228-189" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb228-190"><a href="#cb228-190" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[datamall.lta](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop)"</span>,</span>
<span id="cb228-191"><a href="#cb228-191" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[data.gov](https://data.gov.sg/dataset/lta-mrt-station-exit)"</span>,</span>
<span id="cb228-192"><a href="#cb228-192" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[Onemap.gov](https://www.onemap.gov.sg/main/v2/essentialamenities)"</span>,</span>
<span id="cb228-193"><a href="#cb228-193" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[Valery Lim's Github](https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper/blob/master/mall_coordinates_updated.csv)"</span>,</span>
<span id="cb228-194"><a href="#cb228-194" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[data.gov](https://data.gov.sg/dataset/school-directory-and-information)"</span>)</span>
<span id="cb228-195"><a href="#cb228-195" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb228-196"><a href="#cb228-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-197"><a href="#cb228-197" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb228-198"><a href="#cb228-198" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb228-199"><a href="#cb228-199" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(datasets, <span class="at">caption=</span><span class="st">"Datasets Used"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb228-200"><a href="#cb228-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>(<span class="st">"hover"</span>, <span class="at">latex_options=</span><span class="st">"scale_down"</span>)</span>
<span id="cb228-201"><a href="#cb228-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-202"><a href="#cb228-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-203"><a href="#cb228-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-204"><a href="#cb228-204" aria-hidden="true" tabindex="-1"></a><span class="fu">### Aspatial data</span></span>
<span id="cb228-205"><a href="#cb228-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-206"><a href="#cb228-206" aria-hidden="true" tabindex="-1"></a>For the purpose of this take-home exercise, <span class="co">[</span><span class="ot">`HDB Resale Flat Prices`</span><span class="co">](https://data.gov.sg/dataset/resale-flat-prices)</span> provided by Data.gov.sg should be used as the core data set.</span>
<span id="cb228-207"><a href="#cb228-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-208"><a href="#cb228-208" aria-hidden="true" tabindex="-1"></a>The code chunk below reads the csv file into our R environment.</span>
<span id="cb228-209"><a href="#cb228-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-210"><a href="#cb228-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-211"><a href="#cb228-211" aria-hidden="true" tabindex="-1"></a>resale<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"data/aspatial/resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv"</span>)</span>
<span id="cb228-212"><a href="#cb228-212" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resale,<span class="dv">5</span>)</span>
<span id="cb228-213"><a href="#cb228-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-214"><a href="#cb228-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-215"><a href="#cb228-215" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Filtering to include transactional periods</span></span>
<span id="cb228-216"><a href="#cb228-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-217"><a href="#cb228-217" aria-hidden="true" tabindex="-1"></a>The study should focus on either three-room, four-room or five-room flat and transaction period should be from 1st January 2021 to 31st December 2022. The test data should be January and February 2023 resale prices.</span>
<span id="cb228-218"><a href="#cb228-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-219"><a href="#cb228-219" aria-hidden="true" tabindex="-1"></a>Therefore, we filter the dataset to include transactions occuring from Jan 2021 to Feb 2023.</span>
<span id="cb228-220"><a href="#cb228-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-221"><a href="#cb228-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-222"><a href="#cb228-222" aria-hidden="true" tabindex="-1"></a><span class="co"># transaction period from 01-Jan-21 to 31-Feb-23</span></span>
<span id="cb228-223"><a href="#cb228-223" aria-hidden="true" tabindex="-1"></a><span class="co"># 4-room flats </span></span>
<span id="cb228-224"><a href="#cb228-224" aria-hidden="true" tabindex="-1"></a>resale <span class="ot">&lt;-</span> resale <span class="sc">%&gt;%</span> </span>
<span id="cb228-225"><a href="#cb228-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(flat_type <span class="sc">==</span> <span class="st">"4 ROOM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb228-226"><a href="#cb228-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2021-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2022-12"</span> <span class="sc">|</span> month <span class="sc">&gt;=</span> <span class="st">"2023-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2023-02"</span>)</span>
<span id="cb228-227"><a href="#cb228-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-228"><a href="#cb228-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-229"><a href="#cb228-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-230"><a href="#cb228-230" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>street_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ST</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">"SAINT"</span>, resale<span class="sc">$</span>street_name)</span>
<span id="cb228-231"><a href="#cb228-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-232"><a href="#cb228-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-233"><a href="#cb228-233" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Creating function to get longitude and lattitude</span></span>
<span id="cb228-234"><a href="#cb228-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-235"><a href="#cb228-235" aria-hidden="true" tabindex="-1"></a>Notice that the data provided in the resale flat data does not include coordinates! We need to create our own geocoding function. With reference to our senior Megan's work once again, these are the steps required in creating a geocoding function.</span>
<span id="cb228-236"><a href="#cb228-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-237"><a href="#cb228-237" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Combine the block and street name into an address</span>
<span id="cb228-238"><a href="#cb228-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-239"><a href="#cb228-239" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Pass the address as the searchVal in our query</span>
<span id="cb228-240"><a href="#cb228-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-241"><a href="#cb228-241" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Send the query to OneMapSG search *Note: Since we don't need all the address details, we can set `getAddrDetails` as 'N'*</span>
<span id="cb228-242"><a href="#cb228-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-243"><a href="#cb228-243" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Convert response (JSON object) to text</span>
<span id="cb228-244"><a href="#cb228-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-245"><a href="#cb228-245" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Save response in text form as a dataframe</span>
<span id="cb228-246"><a href="#cb228-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-247"><a href="#cb228-247" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>We only need to retain the latitude and longitude for our output</span>
<span id="cb228-248"><a href="#cb228-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-249"><a href="#cb228-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-250"><a href="#cb228-250" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb228-251"><a href="#cb228-251" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjson)</span>
<span id="cb228-252"><a href="#cb228-252" aria-hidden="true" tabindex="-1"></a>geocode <span class="ot">&lt;-</span> <span class="cf">function</span>(block, streetname) {</span>
<span id="cb228-253"><a href="#cb228-253" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://developers.onemap.sg/commonapi/search"</span></span>
<span id="cb228-254"><a href="#cb228-254" aria-hidden="true" tabindex="-1"></a>  address <span class="ot">&lt;-</span> <span class="fu">paste</span>(block, streetname, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb228-255"><a href="#cb228-255" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"searchVal"</span> <span class="ot">=</span> address, </span>
<span id="cb228-256"><a href="#cb228-256" aria-hidden="true" tabindex="-1"></a>                <span class="st">"returnGeom"</span> <span class="ot">=</span> <span class="st">"Y"</span>,</span>
<span id="cb228-257"><a href="#cb228-257" aria-hidden="true" tabindex="-1"></a>                <span class="st">"getAddrDetails"</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb228-258"><a href="#cb228-258" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pageNum"</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb228-259"><a href="#cb228-259" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-260"><a href="#cb228-260" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb228-261"><a href="#cb228-261" aria-hidden="true" tabindex="-1"></a>  restext<span class="ot">&lt;-</span><span class="fu">content</span>(res, <span class="at">as=</span><span class="st">"text"</span>)</span>
<span id="cb228-262"><a href="#cb228-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-263"><a href="#cb228-263" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(restext)  <span class="sc">%&gt;%</span> </span>
<span id="cb228-264"><a href="#cb228-264" aria-hidden="true" tabindex="-1"></a>    as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb228-265"><a href="#cb228-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(results.LATITUDE, results.LONGITUDE)</span>
<span id="cb228-266"><a href="#cb228-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-267"><a href="#cb228-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb228-268"><a href="#cb228-268" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-269"><a href="#cb228-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-270"><a href="#cb228-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-271"><a href="#cb228-271" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Passing code through resale df</span></span>
<span id="cb228-272"><a href="#cb228-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-273"><a href="#cb228-273" aria-hidden="true" tabindex="-1"></a>With our function in place, we then create a loop to implement the geocoding function through our transaction data. ✌🏼</span>
<span id="cb228-274"><a href="#cb228-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-275"><a href="#cb228-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-276"><a href="#cb228-276" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb228-277"><a href="#cb228-277" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb228-278"><a href="#cb228-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-279"><a href="#cb228-279" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale)){</span>
<span id="cb228-280"><a href="#cb228-280" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(resale[i, <span class="dv">4</span>], resale[i, <span class="dv">5</span>])</span>
<span id="cb228-281"><a href="#cb228-281" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-282"><a href="#cb228-282" aria-hidden="true" tabindex="-1"></a>  resale<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb228-283"><a href="#cb228-283" aria-hidden="true" tabindex="-1"></a>  resale<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb228-284"><a href="#cb228-284" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-285"><a href="#cb228-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-286"><a href="#cb228-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-287"><a href="#cb228-287" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Save as an RDS object</span></span>
<span id="cb228-288"><a href="#cb228-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-289"><a href="#cb228-289" aria-hidden="true" tabindex="-1"></a>Especially given the extensive dataframe, this would take quite long to load! to avoid having to reload the output again, we save this as a RDS object 😵‍💫.</span>
<span id="cb228-290"><a href="#cb228-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-291"><a href="#cb228-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-292"><a href="#cb228-292" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(resale, <span class="at">file=</span><span class="st">"resale"</span>, <span class="at">compress=</span><span class="cn">FALSE</span>)</span>
<span id="cb228-293"><a href="#cb228-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-294"><a href="#cb228-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-295"><a href="#cb228-295" aria-hidden="true" tabindex="-1"></a>now we can read the resale file easily! 🤭</span>
<span id="cb228-296"><a href="#cb228-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-299"><a href="#cb228-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-300"><a href="#cb228-300" aria-hidden="true" tabindex="-1"></a>resale<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">"resale"</span>)</span>
<span id="cb228-301"><a href="#cb228-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-302"><a href="#cb228-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-303"><a href="#cb228-303" aria-hidden="true" tabindex="-1"></a><span class="fu">### Geospatial Data</span></span>
<span id="cb228-304"><a href="#cb228-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-305"><a href="#cb228-305" aria-hidden="true" tabindex="-1"></a>Our geospatial data can be split into several categories</span>
<span id="cb228-306"><a href="#cb228-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-307"><a href="#cb228-307" aria-hidden="true" tabindex="-1"></a>+-------------+-------------------------+------------------------------------------------------+-------------------------------------------------------+</span>
<span id="cb228-308"><a href="#cb228-308" aria-hidden="true" tabindex="-1"></a>|             | Base                    | Extracted                                            | Sourced                                               |</span>
<span id="cb228-309"><a href="#cb228-309" aria-hidden="true" tabindex="-1"></a>+=============+=========================+======================================================+=======================================================+</span>
<span id="cb228-310"><a href="#cb228-310" aria-hidden="true" tabindex="-1"></a>| Description | geographical boundaries | Independent variable data extracted using OneMap API | Independent variable data extracted from the internet |</span>
<span id="cb228-311"><a href="#cb228-311" aria-hidden="true" tabindex="-1"></a>+-------------+-------------------------+------------------------------------------------------+-------------------------------------------------------+</span>
<span id="cb228-312"><a href="#cb228-312" aria-hidden="true" tabindex="-1"></a>| Layer names | 1.  MPSZ-2019           | childcare                                            | 1.  bus stop                                          |</span>
<span id="cb228-313"><a href="#cb228-313" aria-hidden="true" tabindex="-1"></a>|             |                         |                                                      |                                                       |</span>
<span id="cb228-314"><a href="#cb228-314" aria-hidden="true" tabindex="-1"></a>|             |                         | elder care                                           | 2.  shopping mall                                     |</span>
<span id="cb228-315"><a href="#cb228-315" aria-hidden="true" tabindex="-1"></a>|             |                         |                                                      |                                                       |</span>
<span id="cb228-316"><a href="#cb228-316" aria-hidden="true" tabindex="-1"></a>|             |                         | hawker centre                                        | 3.  supermarket                                       |</span>
<span id="cb228-317"><a href="#cb228-317" aria-hidden="true" tabindex="-1"></a>|             |                         |                                                      |                                                       |</span>
<span id="cb228-318"><a href="#cb228-318" aria-hidden="true" tabindex="-1"></a>|             |                         | kindergartens                                        | 4.  mrt                                               |</span>
<span id="cb228-319"><a href="#cb228-319" aria-hidden="true" tabindex="-1"></a>|             |                         |                                                      |                                                       |</span>
<span id="cb228-320"><a href="#cb228-320" aria-hidden="true" tabindex="-1"></a>|             |                         | parks                                                | 5.  primary school                                    |</span>
<span id="cb228-321"><a href="#cb228-321" aria-hidden="true" tabindex="-1"></a>|             |                         |                                                      |                                                       |</span>
<span id="cb228-322"><a href="#cb228-322" aria-hidden="true" tabindex="-1"></a>|             |                         | libraries                                            | 6.  good primary school                               |</span>
<span id="cb228-323"><a href="#cb228-323" aria-hidden="true" tabindex="-1"></a>|             |                         |                                                      |                                                       |</span>
<span id="cb228-324"><a href="#cb228-324" aria-hidden="true" tabindex="-1"></a>|             |                         | sport facilities                                     |                                                       |</span>
<span id="cb228-325"><a href="#cb228-325" aria-hidden="true" tabindex="-1"></a>+-------------+-------------------------+------------------------------------------------------+-------------------------------------------------------+</span>
<span id="cb228-326"><a href="#cb228-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-327"><a href="#cb228-327" aria-hidden="true" tabindex="-1"></a>Feel free to explore the codes we used to extract the data in the different panels below! 🤗</span>
<span id="cb228-328"><a href="#cb228-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-329"><a href="#cb228-329" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb228-330"><a href="#cb228-330" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extracted</span></span>
<span id="cb228-331"><a href="#cb228-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-332"><a href="#cb228-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-333"><a href="#cb228-333" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb228-334"><a href="#cb228-334" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(onemapsgapi)</span>
<span id="cb228-335"><a href="#cb228-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-336"><a href="#cb228-336" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting eldercare data as an sf object into R</span></span>
<span id="cb228-337"><a href="#cb228-337" aria-hidden="true" tabindex="-1"></a>eldercare<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"eldercare"</span>)</span>
<span id="cb228-338"><a href="#cb228-338" aria-hidden="true" tabindex="-1"></a>eldercare.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(eldercare, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-339"><a href="#cb228-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-340"><a href="#cb228-340" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb228-341"><a href="#cb228-341" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> eldercare.sf,</span>
<span id="cb228-342"><a href="#cb228-342" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb228-343"><a href="#cb228-343" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"eldercare"</span>,</span>
<span id="cb228-344"><a href="#cb228-344" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-345"><a href="#cb228-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-346"><a href="#cb228-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-347"><a href="#cb228-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-348"><a href="#cb228-348" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting eldercare data as an sf object into R</span></span>
<span id="cb228-349"><a href="#cb228-349" aria-hidden="true" tabindex="-1"></a>hawkercentre<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"hawkercentre"</span>)</span>
<span id="cb228-350"><a href="#cb228-350" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(hawkercentre, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-351"><a href="#cb228-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-352"><a href="#cb228-352" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb228-353"><a href="#cb228-353" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> hawkercentre.sf,</span>
<span id="cb228-354"><a href="#cb228-354" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb228-355"><a href="#cb228-355" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"hawkercentre"</span>,</span>
<span id="cb228-356"><a href="#cb228-356" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-357"><a href="#cb228-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-358"><a href="#cb228-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-359"><a href="#cb228-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-360"><a href="#cb228-360" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting childcare data as an sf object into R</span></span>
<span id="cb228-361"><a href="#cb228-361" aria-hidden="true" tabindex="-1"></a>childcare<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"childcare"</span>)</span>
<span id="cb228-362"><a href="#cb228-362" aria-hidden="true" tabindex="-1"></a>childcare.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(childcare, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-363"><a href="#cb228-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-364"><a href="#cb228-364" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb228-365"><a href="#cb228-365" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> childcare.sf,</span>
<span id="cb228-366"><a href="#cb228-366" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb228-367"><a href="#cb228-367" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"childcare"</span>,</span>
<span id="cb228-368"><a href="#cb228-368" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-369"><a href="#cb228-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-370"><a href="#cb228-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-371"><a href="#cb228-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-372"><a href="#cb228-372" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting kindergartens data as an sf object into R</span></span>
<span id="cb228-373"><a href="#cb228-373" aria-hidden="true" tabindex="-1"></a>kindergartens<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"kindergartens"</span>)</span>
<span id="cb228-374"><a href="#cb228-374" aria-hidden="true" tabindex="-1"></a>kindergartens.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(kindergartens, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-375"><a href="#cb228-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-376"><a href="#cb228-376" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb228-377"><a href="#cb228-377" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> kindergartens.sf,</span>
<span id="cb228-378"><a href="#cb228-378" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb228-379"><a href="#cb228-379" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"kindergartens"</span>,</span>
<span id="cb228-380"><a href="#cb228-380" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-381"><a href="#cb228-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-382"><a href="#cb228-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-383"><a href="#cb228-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-384"><a href="#cb228-384" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting parks data as an sf object into R</span></span>
<span id="cb228-385"><a href="#cb228-385" aria-hidden="true" tabindex="-1"></a>parks<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"nationalparks"</span>)</span>
<span id="cb228-386"><a href="#cb228-386" aria-hidden="true" tabindex="-1"></a>parks.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(parks, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-387"><a href="#cb228-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-388"><a href="#cb228-388" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb228-389"><a href="#cb228-389" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> parks.sf,</span>
<span id="cb228-390"><a href="#cb228-390" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb228-391"><a href="#cb228-391" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"parks"</span>,</span>
<span id="cb228-392"><a href="#cb228-392" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-393"><a href="#cb228-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-394"><a href="#cb228-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-395"><a href="#cb228-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-396"><a href="#cb228-396" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting library data as an sf object into R</span></span>
<span id="cb228-397"><a href="#cb228-397" aria-hidden="true" tabindex="-1"></a>library<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"libraries"</span>)</span>
<span id="cb228-398"><a href="#cb228-398" aria-hidden="true" tabindex="-1"></a>library.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(library, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-399"><a href="#cb228-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-400"><a href="#cb228-400" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb228-401"><a href="#cb228-401" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> library.sf,</span>
<span id="cb228-402"><a href="#cb228-402" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb228-403"><a href="#cb228-403" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"libraries"</span>,</span>
<span id="cb228-404"><a href="#cb228-404" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-405"><a href="#cb228-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-406"><a href="#cb228-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-407"><a href="#cb228-407" aria-hidden="true" tabindex="-1"></a>Extracting and sports facility data:</span>
<span id="cb228-408"><a href="#cb228-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-409"><a href="#cb228-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-410"><a href="#cb228-410" aria-hidden="true" tabindex="-1"></a>sport<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"sportsg_sport_facilities"</span>)</span>
<span id="cb228-411"><a href="#cb228-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-412"><a href="#cb228-412" aria-hidden="true" tabindex="-1"></a>sport</span>
<span id="cb228-413"><a href="#cb228-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-414"><a href="#cb228-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-415"><a href="#cb228-415" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/Screenshot%202023-03-11%20at%205.46.23%20PM.png)</span></span>
<span id="cb228-416"><a href="#cb228-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-417"><a href="#cb228-417" aria-hidden="true" tabindex="-1"></a>When we browse the sports data, we see that the lat and lng columns are not configured in the way we expect it to be. In the Lng column, the longitude of the location is first placed followed by a "\|" and then the latitude of the location. 🥲</span>
<span id="cb228-418"><a href="#cb228-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-419"><a href="#cb228-419" aria-hidden="true" tabindex="-1"></a>Notice that the Lng and Lat are not in the format we want. We create a function to extract the Lng numbers from the string, using str_extract from the package stringr.</span>
<span id="cb228-420"><a href="#cb228-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-421"><a href="#cb228-421" aria-hidden="true" tabindex="-1"></a>note the use of the following syntax</span>
<span id="cb228-422"><a href="#cb228-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-423"><a href="#cb228-423" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"<span class="sc">\\\\</span>d+" extracts one or more digits that occur before the \| character</span>
<span id="cb228-424"><a href="#cb228-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-425"><a href="#cb228-425" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"<span class="sc">\\</span>.?" matches the decimal point occuring in lng records</span>
<span id="cb228-426"><a href="#cb228-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-427"><a href="#cb228-427" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"<span class="sc">\\</span>d<span class="sc">\*</span>" matches any digits that come after the decimal point</span>
<span id="cb228-428"><a href="#cb228-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-429"><a href="#cb228-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-430"><a href="#cb228-430" aria-hidden="true" tabindex="-1"></a>lng.mutate<span class="ot">&lt;-</span><span class="cf">function</span>(df){</span>
<span id="cb228-431"><a href="#cb228-431" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb228-432"><a href="#cb228-432" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Lng=</span><span class="fu">str_extract</span>(Lng, <span class="st">"</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*"</span>))</span>
<span id="cb228-433"><a href="#cb228-433" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-434"><a href="#cb228-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-435"><a href="#cb228-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-436"><a href="#cb228-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-437"><a href="#cb228-437" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting sports data as an sf object into R</span></span>
<span id="cb228-438"><a href="#cb228-438" aria-hidden="true" tabindex="-1"></a>sport<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"sportsg_sport_facilities"</span>)</span>
<span id="cb228-439"><a href="#cb228-439" aria-hidden="true" tabindex="-1"></a>sport<span class="ot">&lt;-</span><span class="fu">lng.mutate</span>(sport)</span>
<span id="cb228-440"><a href="#cb228-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-441"><a href="#cb228-441" aria-hidden="true" tabindex="-1"></a>sport.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sport, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-442"><a href="#cb228-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-443"><a href="#cb228-443" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a saved sf object in data file for easy reference</span></span>
<span id="cb228-444"><a href="#cb228-444" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> sport.sf,</span>
<span id="cb228-445"><a href="#cb228-445" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>,</span>
<span id="cb228-446"><a href="#cb228-446" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"sportsg_sport_facilities"</span>,</span>
<span id="cb228-447"><a href="#cb228-447" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-448"><a href="#cb228-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-449"><a href="#cb228-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-450"><a href="#cb228-450" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sourced</span></span>
<span id="cb228-451"><a href="#cb228-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-452"><a href="#cb228-452" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Bus stop data Extracted from: <span class="co">[</span><span class="ot">datamall.lta</span><span class="co">](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop)</span></span>
<span id="cb228-453"><a href="#cb228-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-454"><a href="#cb228-454" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Supermarkets extracted data from: <span class="co">[</span><span class="ot">Onemap.gov</span><span class="co">](https://www.onemap.gov.sg/main/v2/essentialamenities)</span></span>
<span id="cb228-455"><a href="#cb228-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-456"><a href="#cb228-456" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Shopping mall data Extracted from: <span class="co">[</span><span class="ot">ValeryLim's Github</span><span class="co">](https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper/blob/master/mall_coordinates_updated.csv)</span></span>
<span id="cb228-457"><a href="#cb228-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-458"><a href="#cb228-458" aria-hidden="true" tabindex="-1"></a>since it is in a csv file, we convert it into a shape file and save it into our extracted data file in the code chunk below</span>
<span id="cb228-459"><a href="#cb228-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-460"><a href="#cb228-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-461"><a href="#cb228-461" aria-hidden="true" tabindex="-1"></a>mall.df<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/geospatial/sourced/mall_coordinates_updated.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb228-462"><a href="#cb228-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(latitude, longitude, name) <span class="sc">|&gt;</span> </span>
<span id="cb228-463"><a href="#cb228-463" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(name)</span>
<span id="cb228-464"><a href="#cb228-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-465"><a href="#cb228-465" aria-hidden="true" tabindex="-1"></a>mall.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(mall.df, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-466"><a href="#cb228-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-467"><a href="#cb228-467" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> mall.sf,</span>
<span id="cb228-468"><a href="#cb228-468" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb228-469"><a href="#cb228-469" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"shoppingmall"</span>,</span>
<span id="cb228-470"><a href="#cb228-470" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-471"><a href="#cb228-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-472"><a href="#cb228-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-473"><a href="#cb228-473" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Primary school data extracted from <span class="co">[</span><span class="ot">data.gov</span><span class="co">](https://data.gov.sg/dataset/school-directory-and-information)</span></span>
<span id="cb228-474"><a href="#cb228-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-475"><a href="#cb228-475" aria-hidden="true" tabindex="-1"></a>Since only postal code and address data is given, we use the OneMapAPI in the code below to obtain coordinates of the schools.</span>
<span id="cb228-476"><a href="#cb228-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-477"><a href="#cb228-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-478"><a href="#cb228-478" aria-hidden="true" tabindex="-1"></a>primarysch.df<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/geospatial/sourced/general-information-of-schools.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb228-479"><a href="#cb228-479" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(mainlevel_code<span class="sc">==</span><span class="st">"PRIMARY"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb228-480"><a href="#cb228-480" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(school_name, postal_code) <span class="sc">|&gt;</span> </span>
<span id="cb228-481"><a href="#cb228-481" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">postal_code=</span><span class="fu">ifelse</span>(<span class="fu">nchar</span>(<span class="fu">as.character</span>(postal_code)) <span class="sc">==</span> <span class="dv">5</span>, </span>
<span id="cb228-482"><a href="#cb228-482" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">paste0</span>(<span class="st">"0"</span>, <span class="fu">as.character</span>(postal_code)), </span>
<span id="cb228-483"><a href="#cb228-483" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.character</span>(postal_code)))</span>
<span id="cb228-484"><a href="#cb228-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-485"><a href="#cb228-485" aria-hidden="true" tabindex="-1"></a><span class="co">#use onemap api</span></span>
<span id="cb228-486"><a href="#cb228-486" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb228-487"><a href="#cb228-487" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjson)</span>
<span id="cb228-488"><a href="#cb228-488" aria-hidden="true" tabindex="-1"></a>geocode.data.gov <span class="ot">&lt;-</span> <span class="cf">function</span>(postalcode) {</span>
<span id="cb228-489"><a href="#cb228-489" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://developers.onemap.sg/commonapi/search"</span></span>
<span id="cb228-490"><a href="#cb228-490" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"searchVal"</span> <span class="ot">=</span> postalcode, </span>
<span id="cb228-491"><a href="#cb228-491" aria-hidden="true" tabindex="-1"></a>                <span class="st">"returnGeom"</span> <span class="ot">=</span> <span class="st">"Y"</span>,</span>
<span id="cb228-492"><a href="#cb228-492" aria-hidden="true" tabindex="-1"></a>                <span class="st">"getAddrDetails"</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb228-493"><a href="#cb228-493" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pageNum"</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb228-494"><a href="#cb228-494" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-495"><a href="#cb228-495" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb228-496"><a href="#cb228-496" aria-hidden="true" tabindex="-1"></a>  restext<span class="ot">&lt;-</span><span class="fu">content</span>(res, <span class="at">as=</span><span class="st">"text"</span>)</span>
<span id="cb228-497"><a href="#cb228-497" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-498"><a href="#cb228-498" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(restext) <span class="sc">|&gt;</span>  </span>
<span id="cb228-499"><a href="#cb228-499" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb228-500"><a href="#cb228-500" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(results.LATITUDE, results.LONGITUDE)</span>
<span id="cb228-501"><a href="#cb228-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-502"><a href="#cb228-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb228-503"><a href="#cb228-503" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-504"><a href="#cb228-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-505"><a href="#cb228-505" aria-hidden="true" tabindex="-1"></a><span class="co">#create loop to run data through</span></span>
<span id="cb228-506"><a href="#cb228-506" aria-hidden="true" tabindex="-1"></a>primarysch.df<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb228-507"><a href="#cb228-507" aria-hidden="true" tabindex="-1"></a>primarysch.df<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb228-508"><a href="#cb228-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-509"><a href="#cb228-509" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(primarysch.df)){</span>
<span id="cb228-510"><a href="#cb228-510" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode.data.gov</span>(primarysch.df[i, <span class="dv">2</span>])</span>
<span id="cb228-511"><a href="#cb228-511" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-512"><a href="#cb228-512" aria-hidden="true" tabindex="-1"></a>  primarysch.df<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb228-513"><a href="#cb228-513" aria-hidden="true" tabindex="-1"></a>  primarysch.df<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb228-514"><a href="#cb228-514" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-515"><a href="#cb228-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-516"><a href="#cb228-516" aria-hidden="true" tabindex="-1"></a>primarysch.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(primarysch.df, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb228-517"><a href="#cb228-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-518"><a href="#cb228-518" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> primarysch.sf,</span>
<span id="cb228-519"><a href="#cb228-519" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb228-520"><a href="#cb228-520" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"primarysch"</span>,</span>
<span id="cb228-521"><a href="#cb228-521" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-522"><a href="#cb228-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-523"><a href="#cb228-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-524"><a href="#cb228-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-525"><a href="#cb228-525" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Good primary school - filtered from primarysch.sf</span>
<span id="cb228-526"><a href="#cb228-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-527"><a href="#cb228-527" aria-hidden="true" tabindex="-1"></a>Based on the rankings of <span class="co">[</span><span class="ot">this website</span><span class="co">](https://schlah.com/primary-schools)</span>, we take the first 10 schools</span>
<span id="cb228-528"><a href="#cb228-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-529"><a href="#cb228-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-530"><a href="#cb228-530" aria-hidden="true" tabindex="-1"></a>primarysch.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"primarysch"</span>)</span>
<span id="cb228-531"><a href="#cb228-531" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf <span class="ot">&lt;-</span> primarysch.sf <span class="sc">|&gt;</span> </span>
<span id="cb228-532"><a href="#cb228-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(school_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"NANYANG PRIMARY SCHOOL"</span>,</span>
<span id="cb228-533"><a href="#cb228-533" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"TAO NAN SCHOOL"</span>,</span>
<span id="cb228-534"><a href="#cb228-534" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"CANOSSA CATHOLIC PRIMARY SCHOOL"</span>,</span>
<span id="cb228-535"><a href="#cb228-535" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"NAN HUA PRIMARY SCHOOL"</span>,</span>
<span id="cb228-536"><a href="#cb228-536" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"ST. HILDA'S PRIMARY SCHOOL"</span>,</span>
<span id="cb228-537"><a href="#cb228-537" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"HENRY PARK PRIMARY SCHOOL"</span>,</span>
<span id="cb228-538"><a href="#cb228-538" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"ANGLO-CHINESE SCHOOL (PRIMARY)"</span>,</span>
<span id="cb228-539"><a href="#cb228-539" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"RAFFLES GIRLS' PRIMARY SCHOOL"</span>,</span>
<span id="cb228-540"><a href="#cb228-540" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PEI HWA PRESBYTERIAN PRIMARY SCHOOL"</span></span>
<span id="cb228-541"><a href="#cb228-541" aria-hidden="true" tabindex="-1"></a>                            ))</span>
<span id="cb228-542"><a href="#cb228-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-543"><a href="#cb228-543" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> goodprimarysch.sf,</span>
<span id="cb228-544"><a href="#cb228-544" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb228-545"><a href="#cb228-545" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"goodprimarysch"</span>,</span>
<span id="cb228-546"><a href="#cb228-546" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb228-547"><a href="#cb228-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-548"><a href="#cb228-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-549"><a href="#cb228-549" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Mrt data: retrieved from <span class="co">[</span><span class="ot">data.gov</span><span class="co">](https://data.gov.sg/dataset/lta-mrt-station-exit)</span></span>
<span id="cb228-550"><a href="#cb228-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-551"><a href="#cb228-551" aria-hidden="true" tabindex="-1"></a>The data given to us is in ".kml" format, we convert it to an sf object.</span>
<span id="cb228-552"><a href="#cb228-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-553"><a href="#cb228-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-554"><a href="#cb228-554" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn=</span> <span class="st">"data/geospatial/sourced/lta-mrt-station-exit-kml.kml"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb228-555"><a href="#cb228-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_zm</span>()</span>
<span id="cb228-556"><a href="#cb228-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-557"><a href="#cb228-557" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> mrt.sf,</span>
<span id="cb228-558"><a href="#cb228-558" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>,</span>
<span id="cb228-559"><a href="#cb228-559" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"mrt"</span>,</span>
<span id="cb228-560"><a href="#cb228-560" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>,</span>
<span id="cb228-561"><a href="#cb228-561" aria-hidden="true" tabindex="-1"></a>         <span class="at">append =</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-562"><a href="#cb228-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-563"><a href="#cb228-563" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb228-564"><a href="#cb228-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-565"><a href="#cb228-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reading collected geospatial data into R</span></span>
<span id="cb228-566"><a href="#cb228-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-567"><a href="#cb228-567" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb228-568"><a href="#cb228-568" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Base</span></span>
<span id="cb228-569"><a href="#cb228-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-572"><a href="#cb228-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-573"><a href="#cb228-573" aria-hidden="true" tabindex="-1"></a>mpsz.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/base"</span>, <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>)</span>
<span id="cb228-574"><a href="#cb228-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-575"><a href="#cb228-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-576"><a href="#cb228-576" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extracted</span></span>
<span id="cb228-577"><a href="#cb228-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-580"><a href="#cb228-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-581"><a href="#cb228-581" aria-hidden="true" tabindex="-1"></a>eldercare.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"eldercare"</span>)</span>
<span id="cb228-582"><a href="#cb228-582" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"hawkercentre"</span>)</span>
<span id="cb228-583"><a href="#cb228-583" aria-hidden="true" tabindex="-1"></a>childcare.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"childcare"</span>)</span>
<span id="cb228-584"><a href="#cb228-584" aria-hidden="true" tabindex="-1"></a>kindergartens.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"kindergartens"</span>)</span>
<span id="cb228-585"><a href="#cb228-585" aria-hidden="true" tabindex="-1"></a>parks.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"parks"</span>)</span>
<span id="cb228-586"><a href="#cb228-586" aria-hidden="true" tabindex="-1"></a>library.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"libraries"</span>)</span>
<span id="cb228-587"><a href="#cb228-587" aria-hidden="true" tabindex="-1"></a>sport.sf<span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/extracted"</span>, <span class="at">layer =</span> <span class="st">"sportsg_sport_facilities"</span>)</span>
<span id="cb228-588"><a href="#cb228-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-589"><a href="#cb228-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-590"><a href="#cb228-590" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sourced</span></span>
<span id="cb228-591"><a href="#cb228-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-594"><a href="#cb228-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-595"><a href="#cb228-595" aria-hidden="true" tabindex="-1"></a>busstop.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"BusStop"</span>)</span>
<span id="cb228-596"><a href="#cb228-596" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"shoppingmall"</span>)</span>
<span id="cb228-597"><a href="#cb228-597" aria-hidden="true" tabindex="-1"></a>supermarket.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"SUPERMARKETS"</span>)</span>
<span id="cb228-598"><a href="#cb228-598" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"mrt"</span>)</span>
<span id="cb228-599"><a href="#cb228-599" aria-hidden="true" tabindex="-1"></a>primarysch.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"primarysch"</span>)</span>
<span id="cb228-600"><a href="#cb228-600" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/sourced"</span>, <span class="at">layer =</span> <span class="st">"goodprimarysch"</span>)</span>
<span id="cb228-601"><a href="#cb228-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-602"><a href="#cb228-602" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb228-603"><a href="#cb228-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-604"><a href="#cb228-604" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data pre-processing</span></span>
<span id="cb228-605"><a href="#cb228-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-606"><a href="#cb228-606" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Removing unnecessary columns**</span></span>
<span id="cb228-607"><a href="#cb228-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-608"><a href="#cb228-608" aria-hidden="true" tabindex="-1"></a>For locational factor dataframes, we only need to know the name of the facility and its geometry column.</span>
<span id="cb228-609"><a href="#cb228-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-612"><a href="#cb228-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-613"><a href="#cb228-613" aria-hidden="true" tabindex="-1"></a>eldercare.sf<span class="ot">&lt;-</span><span class="fu">select</span>(eldercare.sf, <span class="dv">1</span>)</span>
<span id="cb228-614"><a href="#cb228-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-615"><a href="#cb228-615" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf<span class="ot">&lt;-</span><span class="fu">select</span>(hawkercentre.sf, <span class="dv">1</span>)</span>
<span id="cb228-616"><a href="#cb228-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-617"><a href="#cb228-617" aria-hidden="true" tabindex="-1"></a>childcare.sf<span class="ot">&lt;-</span><span class="fu">select</span>(childcare.sf, <span class="dv">1</span>)</span>
<span id="cb228-618"><a href="#cb228-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-619"><a href="#cb228-619" aria-hidden="true" tabindex="-1"></a>parks.sf<span class="ot">&lt;-</span><span class="fu">select</span>(parks.sf, <span class="dv">1</span>)</span>
<span id="cb228-620"><a href="#cb228-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-621"><a href="#cb228-621" aria-hidden="true" tabindex="-1"></a>library.sf<span class="ot">&lt;-</span><span class="fu">select</span>(library.sf, <span class="dv">1</span>)</span>
<span id="cb228-622"><a href="#cb228-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-623"><a href="#cb228-623" aria-hidden="true" tabindex="-1"></a>sport.sf<span class="ot">&lt;-</span><span class="fu">select</span>(sport.sf, <span class="dv">1</span>)</span>
<span id="cb228-624"><a href="#cb228-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-625"><a href="#cb228-625" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf<span class="ot">&lt;-</span><span class="fu">select</span>(shoppingmall.sf, <span class="dv">1</span>)</span>
<span id="cb228-626"><a href="#cb228-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-627"><a href="#cb228-627" aria-hidden="true" tabindex="-1"></a>busstop.sf<span class="ot">&lt;-</span><span class="fu">select</span>(busstop.sf, <span class="dv">1</span>)</span>
<span id="cb228-628"><a href="#cb228-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-629"><a href="#cb228-629" aria-hidden="true" tabindex="-1"></a>supermarket.sf<span class="ot">&lt;-</span> <span class="fu">select</span>(supermarket.sf, <span class="dv">1</span>)</span>
<span id="cb228-630"><a href="#cb228-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-631"><a href="#cb228-631" aria-hidden="true" tabindex="-1"></a>primarysch.sf<span class="ot">&lt;-</span><span class="fu">select</span>(primarysch.sf, <span class="dv">1</span>)</span>
<span id="cb228-632"><a href="#cb228-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-633"><a href="#cb228-633" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf<span class="ot">&lt;-</span><span class="fu">select</span>(goodprimarysch.sf, <span class="dv">1</span>)</span>
<span id="cb228-634"><a href="#cb228-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-635"><a href="#cb228-635" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">select</span>(mrt.sf, <span class="dv">1</span>)</span>
<span id="cb228-636"><a href="#cb228-636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-637"><a href="#cb228-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-638"><a href="#cb228-638" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Check for invalid geometries**</span></span>
<span id="cb228-639"><a href="#cb228-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-642"><a href="#cb228-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-643"><a href="#cb228-643" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(eldercare.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-644"><a href="#cb228-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-645"><a href="#cb228-645" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(hawkercentre.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-646"><a href="#cb228-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-647"><a href="#cb228-647" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(childcare.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-648"><a href="#cb228-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-649"><a href="#cb228-649" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(kindergartens.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-650"><a href="#cb228-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-651"><a href="#cb228-651" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(parks.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-652"><a href="#cb228-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-653"><a href="#cb228-653" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(library.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-654"><a href="#cb228-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-655"><a href="#cb228-655" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(sport.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-656"><a href="#cb228-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-657"><a href="#cb228-657" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(busstop.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-658"><a href="#cb228-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-659"><a href="#cb228-659" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(shoppingmall.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-660"><a href="#cb228-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-661"><a href="#cb228-661" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(supermarket.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-662"><a href="#cb228-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-663"><a href="#cb228-663" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(primarysch.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-664"><a href="#cb228-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-665"><a href="#cb228-665" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(goodprimarysch.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-666"><a href="#cb228-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-667"><a href="#cb228-667" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mrt.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-668"><a href="#cb228-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-669"><a href="#cb228-669" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mpsz.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-670"><a href="#cb228-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-671"><a href="#cb228-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-672"><a href="#cb228-672" aria-hidden="true" tabindex="-1"></a>We see that mpsz has 6 invalid geometries. Lets address them and check again</span>
<span id="cb228-673"><a href="#cb228-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-676"><a href="#cb228-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-677"><a href="#cb228-677" aria-hidden="true" tabindex="-1"></a>mpsz.sf <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(mpsz.sf)</span>
<span id="cb228-678"><a href="#cb228-678" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mpsz.sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb228-679"><a href="#cb228-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-680"><a href="#cb228-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-681"><a href="#cb228-681" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Check for missing values**</span></span>
<span id="cb228-682"><a href="#cb228-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-685"><a href="#cb228-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-686"><a href="#cb228-686" aria-hidden="true" tabindex="-1"></a>eldercare.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(eldercare.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-687"><a href="#cb228-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-688"><a href="#cb228-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-691"><a href="#cb228-691" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-692"><a href="#cb228-692" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(hawkercentre.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-693"><a href="#cb228-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-694"><a href="#cb228-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-697"><a href="#cb228-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-698"><a href="#cb228-698" aria-hidden="true" tabindex="-1"></a>childcare.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(childcare.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-699"><a href="#cb228-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-700"><a href="#cb228-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-703"><a href="#cb228-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-704"><a href="#cb228-704" aria-hidden="true" tabindex="-1"></a>kindergartens.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(kindergartens.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-705"><a href="#cb228-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-706"><a href="#cb228-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-709"><a href="#cb228-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-710"><a href="#cb228-710" aria-hidden="true" tabindex="-1"></a>parks.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(parks.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-711"><a href="#cb228-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-712"><a href="#cb228-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-715"><a href="#cb228-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-716"><a href="#cb228-716" aria-hidden="true" tabindex="-1"></a>library.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(library.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-717"><a href="#cb228-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-718"><a href="#cb228-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-721"><a href="#cb228-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-722"><a href="#cb228-722" aria-hidden="true" tabindex="-1"></a>sport.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(sport.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-723"><a href="#cb228-723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-724"><a href="#cb228-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-727"><a href="#cb228-727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-728"><a href="#cb228-728" aria-hidden="true" tabindex="-1"></a>busstop.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(busstop.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-729"><a href="#cb228-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-730"><a href="#cb228-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-733"><a href="#cb228-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-734"><a href="#cb228-734" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(shoppingmall.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-735"><a href="#cb228-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-736"><a href="#cb228-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-739"><a href="#cb228-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-740"><a href="#cb228-740" aria-hidden="true" tabindex="-1"></a>supermarket.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(supermarket.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-741"><a href="#cb228-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-742"><a href="#cb228-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-745"><a href="#cb228-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-746"><a href="#cb228-746" aria-hidden="true" tabindex="-1"></a>primarysch.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(primarysch.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-747"><a href="#cb228-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-748"><a href="#cb228-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-751"><a href="#cb228-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-752"><a href="#cb228-752" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(goodprimarysch.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-753"><a href="#cb228-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-754"><a href="#cb228-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-757"><a href="#cb228-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-758"><a href="#cb228-758" aria-hidden="true" tabindex="-1"></a>mrt.sf[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(mrt.sf))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb228-759"><a href="#cb228-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-760"><a href="#cb228-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-761"><a href="#cb228-761" aria-hidden="true" tabindex="-1"></a><span class="fu">### Verifying + Transforming Coordinate system</span></span>
<span id="cb228-762"><a href="#cb228-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-763"><a href="#cb228-763" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb228-764"><a href="#cb228-764" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Base</span></span>
<span id="cb228-765"><a href="#cb228-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-768"><a href="#cb228-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-769"><a href="#cb228-769" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mpsz.sf)</span>
<span id="cb228-770"><a href="#cb228-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-771"><a href="#cb228-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-772"><a href="#cb228-772" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extracted</span></span>
<span id="cb228-773"><a href="#cb228-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-776"><a href="#cb228-776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-777"><a href="#cb228-777" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(eldercare.sf)</span>
<span id="cb228-778"><a href="#cb228-778" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(hawkercentre.sf)</span>
<span id="cb228-779"><a href="#cb228-779" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(childcare.sf)</span>
<span id="cb228-780"><a href="#cb228-780" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(kindergartens.sf)</span>
<span id="cb228-781"><a href="#cb228-781" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(parks.sf)</span>
<span id="cb228-782"><a href="#cb228-782" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(library.sf)</span>
<span id="cb228-783"><a href="#cb228-783" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(sport.sf)</span>
<span id="cb228-784"><a href="#cb228-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-785"><a href="#cb228-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-786"><a href="#cb228-786" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sourced</span></span>
<span id="cb228-787"><a href="#cb228-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-790"><a href="#cb228-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-791"><a href="#cb228-791" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(busstop.sf)</span>
<span id="cb228-792"><a href="#cb228-792" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(shoppingmall.sf)</span>
<span id="cb228-793"><a href="#cb228-793" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(supermarket.sf)</span>
<span id="cb228-794"><a href="#cb228-794" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(primarysch.sf)</span>
<span id="cb228-795"><a href="#cb228-795" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(goodprimarysch.sf)</span>
<span id="cb228-796"><a href="#cb228-796" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mrt.sf)</span>
<span id="cb228-797"><a href="#cb228-797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-798"><a href="#cb228-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-799"><a href="#cb228-799" aria-hidden="true" tabindex="-1"></a>Note: our projected CRS should be SVY21 (EPSG code 3414). However, some of the extracted data sets are in WGS84, and others are in SVY21 with the incorrect EPSG code (EPSG 9001)</span>
<span id="cb228-800"><a href="#cb228-800" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb228-801"><a href="#cb228-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-802"><a href="#cb228-802" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transforming CRS</span></span>
<span id="cb228-803"><a href="#cb228-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-804"><a href="#cb228-804" aria-hidden="true" tabindex="-1"></a>With the invalid geometries found earlier, we use the functions st_set_crs() and st_transform() to correct them.</span>
<span id="cb228-805"><a href="#cb228-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-808"><a href="#cb228-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-809"><a href="#cb228-809" aria-hidden="true" tabindex="-1"></a><span class="co">#st_set_crs() assigns proper EPSG code</span></span>
<span id="cb228-810"><a href="#cb228-810" aria-hidden="true" tabindex="-1"></a>busstop.sf<span class="ot">&lt;-</span><span class="fu">st_set_crs</span>(busstop.sf, <span class="dv">3414</span>)</span>
<span id="cb228-811"><a href="#cb228-811" aria-hidden="true" tabindex="-1"></a>supermarket.sf<span class="ot">&lt;-</span><span class="fu">st_set_crs</span>(supermarket.sf, <span class="dv">3414</span>)</span>
<span id="cb228-812"><a href="#cb228-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-813"><a href="#cb228-813" aria-hidden="true" tabindex="-1"></a><span class="co">#st_transform() changes CRS from one to another</span></span>
<span id="cb228-814"><a href="#cb228-814" aria-hidden="true" tabindex="-1"></a>eldercare.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(eldercare.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-815"><a href="#cb228-815" aria-hidden="true" tabindex="-1"></a>hawkercentre.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(hawkercentre.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-816"><a href="#cb228-816" aria-hidden="true" tabindex="-1"></a>childcare.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(childcare.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-817"><a href="#cb228-817" aria-hidden="true" tabindex="-1"></a>kindergartens.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(kindergartens.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-818"><a href="#cb228-818" aria-hidden="true" tabindex="-1"></a>parks.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(parks.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-819"><a href="#cb228-819" aria-hidden="true" tabindex="-1"></a>library.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(library.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-820"><a href="#cb228-820" aria-hidden="true" tabindex="-1"></a>sport.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(sport.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-821"><a href="#cb228-821" aria-hidden="true" tabindex="-1"></a>shoppingmall.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(shoppingmall.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-822"><a href="#cb228-822" aria-hidden="true" tabindex="-1"></a>primarysch.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(primarysch.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-823"><a href="#cb228-823" aria-hidden="true" tabindex="-1"></a>goodprimarysch.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(goodprimarysch.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-824"><a href="#cb228-824" aria-hidden="true" tabindex="-1"></a>mrt.sf<span class="ot">&lt;-</span><span class="fu">st_transform</span>(mrt.sf, <span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-825"><a href="#cb228-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-826"><a href="#cb228-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-827"><a href="#cb228-827" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checking crs</span></span>
<span id="cb228-828"><a href="#cb228-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-829"><a href="#cb228-829" aria-hidden="true" tabindex="-1"></a>Subsequently, we check again to make sure the data is in the proper CRS.</span>
<span id="cb228-830"><a href="#cb228-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-831"><a href="#cb228-831" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb228-832"><a href="#cb228-832" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Base</span></span>
<span id="cb228-833"><a href="#cb228-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-836"><a href="#cb228-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-837"><a href="#cb228-837" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mpsz.sf)</span>
<span id="cb228-838"><a href="#cb228-838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-839"><a href="#cb228-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-840"><a href="#cb228-840" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extracted</span></span>
<span id="cb228-841"><a href="#cb228-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-844"><a href="#cb228-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-845"><a href="#cb228-845" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(eldercare.sf)</span>
<span id="cb228-846"><a href="#cb228-846" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(hawkercentre.sf)</span>
<span id="cb228-847"><a href="#cb228-847" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(childcare.sf)</span>
<span id="cb228-848"><a href="#cb228-848" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(kindergartens.sf)</span>
<span id="cb228-849"><a href="#cb228-849" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(parks.sf)</span>
<span id="cb228-850"><a href="#cb228-850" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(library.sf)</span>
<span id="cb228-851"><a href="#cb228-851" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(sport.sf)</span>
<span id="cb228-852"><a href="#cb228-852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-853"><a href="#cb228-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-854"><a href="#cb228-854" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sourced</span></span>
<span id="cb228-855"><a href="#cb228-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-858"><a href="#cb228-858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-859"><a href="#cb228-859" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(busstop.sf)</span>
<span id="cb228-860"><a href="#cb228-860" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(shoppingmall.sf)</span>
<span id="cb228-861"><a href="#cb228-861" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(supermarket.sf)</span>
<span id="cb228-862"><a href="#cb228-862" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(primarysch.sf)</span>
<span id="cb228-863"><a href="#cb228-863" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(goodprimarysch.sf)</span>
<span id="cb228-864"><a href="#cb228-864" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mrt.sf)</span>
<span id="cb228-865"><a href="#cb228-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-866"><a href="#cb228-866" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb228-867"><a href="#cb228-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-868"><a href="#cb228-868" aria-hidden="true" tabindex="-1"></a>Everything looks fine! 🙃We are now done with wrangling our collected datasets!</span>
<span id="cb228-869"><a href="#cb228-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-870"><a href="#cb228-870" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploratory Data Analysis</span></span>
<span id="cb228-871"><a href="#cb228-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-872"><a href="#cb228-872" aria-hidden="true" tabindex="-1"></a>Lets do a quick EDA for the data we collected!</span>
<span id="cb228-873"><a href="#cb228-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-874"><a href="#cb228-874" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb228-875"><a href="#cb228-875" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transportation 🚃</span></span>
<span id="cb228-876"><a href="#cb228-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-879"><a href="#cb228-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-880"><a href="#cb228-880" aria-hidden="true" tabindex="-1"></a><span class="co">#transport graph</span></span>
<span id="cb228-881"><a href="#cb228-881" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb228-882"><a href="#cb228-882" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz.sf) <span class="sc">+</span></span>
<span id="cb228-883"><a href="#cb228-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-884"><a href="#cb228-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb228-885"><a href="#cb228-885" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(busstop.sf) <span class="sc">+</span></span>
<span id="cb228-886"><a href="#cb228-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-887"><a href="#cb228-887" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mrt.sf) <span class="sc">+</span></span>
<span id="cb228-888"><a href="#cb228-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"green"</span>, <span class="at">alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb228-889"><a href="#cb228-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Transportation"</span>,</span>
<span id="cb228-890"><a href="#cb228-890" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb228-891"><a href="#cb228-891" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb228-892"><a href="#cb228-892" aria-hidden="true" tabindex="-1"></a>          <span class="at">frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-893"><a href="#cb228-893" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-894"><a href="#cb228-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-895"><a href="#cb228-895" aria-hidden="true" tabindex="-1"></a><span class="fu">### Education 📚</span></span>
<span id="cb228-896"><a href="#cb228-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-899"><a href="#cb228-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-900"><a href="#cb228-900" aria-hidden="true" tabindex="-1"></a><span class="co">#education</span></span>
<span id="cb228-901"><a href="#cb228-901" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb228-902"><a href="#cb228-902" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz.sf) <span class="sc">+</span></span>
<span id="cb228-903"><a href="#cb228-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-904"><a href="#cb228-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb228-905"><a href="#cb228-905" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(primarysch.sf) <span class="sc">+</span></span>
<span id="cb228-906"><a href="#cb228-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"pink"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-907"><a href="#cb228-907" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(goodprimarysch.sf) <span class="sc">+</span></span>
<span id="cb228-908"><a href="#cb228-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb228-909"><a href="#cb228-909" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kindergartens.sf) <span class="sc">+</span></span>
<span id="cb228-910"><a href="#cb228-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-911"><a href="#cb228-911" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(childcare.sf) <span class="sc">+</span></span>
<span id="cb228-912"><a href="#cb228-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"yellow"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb228-913"><a href="#cb228-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Education"</span>,</span>
<span id="cb228-914"><a href="#cb228-914" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb228-915"><a href="#cb228-915" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb228-916"><a href="#cb228-916" aria-hidden="true" tabindex="-1"></a>          <span class="at">frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-917"><a href="#cb228-917" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-918"><a href="#cb228-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-919"><a href="#cb228-919" aria-hidden="true" tabindex="-1"></a><span class="fu">### Amenities 🚲</span></span>
<span id="cb228-920"><a href="#cb228-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-923"><a href="#cb228-923" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-924"><a href="#cb228-924" aria-hidden="true" tabindex="-1"></a><span class="co">#ammenities</span></span>
<span id="cb228-925"><a href="#cb228-925" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb228-926"><a href="#cb228-926" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz.sf) <span class="sc">+</span></span>
<span id="cb228-927"><a href="#cb228-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-928"><a href="#cb228-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb228-929"><a href="#cb228-929" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(parks.sf) <span class="sc">+</span></span>
<span id="cb228-930"><a href="#cb228-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"green"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-931"><a href="#cb228-931" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hawkercentre.sf) <span class="sc">+</span></span>
<span id="cb228-932"><a href="#cb228-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"blue"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-933"><a href="#cb228-933" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(library.sf) <span class="sc">+</span></span>
<span id="cb228-934"><a href="#cb228-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-935"><a href="#cb228-935" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(sport.sf) <span class="sc">+</span></span>
<span id="cb228-936"><a href="#cb228-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"grey"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb228-937"><a href="#cb228-937" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shoppingmall.sf) <span class="sc">+</span></span>
<span id="cb228-938"><a href="#cb228-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb228-939"><a href="#cb228-939" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(supermarket.sf) <span class="sc">+</span></span>
<span id="cb228-940"><a href="#cb228-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"brown"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb228-941"><a href="#cb228-941" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(eldercare.sf) <span class="sc">+</span></span>
<span id="cb228-942"><a href="#cb228-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">"navy"</span>, <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb228-943"><a href="#cb228-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Ammenities"</span>,</span>
<span id="cb228-944"><a href="#cb228-944" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb228-945"><a href="#cb228-945" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb228-946"><a href="#cb228-946" aria-hidden="true" tabindex="-1"></a>          <span class="at">frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-947"><a href="#cb228-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-948"><a href="#cb228-948" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb228-949"><a href="#cb228-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-950"><a href="#cb228-950" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Wrangling {#data-wrangling-1}</span></span>
<span id="cb228-951"><a href="#cb228-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-952"><a href="#cb228-952" aria-hidden="true" tabindex="-1"></a><span class="fu">### Structural Factors</span></span>
<span id="cb228-953"><a href="#cb228-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-954"><a href="#cb228-954" aria-hidden="true" tabindex="-1"></a>This includes the inherent structural factors of the flats, including Area, Floor Level and Lease Remaining years.</span>
<span id="cb228-955"><a href="#cb228-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-956"><a href="#cb228-956" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Floor Level - create as ordinal</span></span>
<span id="cb228-957"><a href="#cb228-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-958"><a href="#cb228-958" aria-hidden="true" tabindex="-1"></a>To simplify analysis, we create the an ordinal column for the floor level variable. This code chunk matches the story levels to the list, and gives it an ordinal value based on its relative positioning in the list given (1 would be allocated to "01 TO 03", 2 allocated to "04 TO 06"....).</span>
<span id="cb228-959"><a href="#cb228-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-962"><a href="#cb228-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-963"><a href="#cb228-963" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the story levels and ordinal values </span></span>
<span id="cb228-964"><a href="#cb228-964" aria-hidden="true" tabindex="-1"></a>story_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"01 TO 03"</span>, <span class="st">"04 TO 06"</span>, <span class="st">"07 TO 09"</span>, <span class="st">"10 TO 12"</span>, <span class="st">"13 TO 15"</span>, <span class="st">"16 TO 18"</span>, <span class="st">"19 TO 21"</span>, <span class="st">"22 TO 24"</span>, <span class="st">"25 TO 27"</span>, <span class="st">"28 TO 30"</span>, <span class="st">"31 TO 33"</span>, <span class="st">"34 TO 36"</span>, <span class="st">"37 TO 39"</span>, <span class="st">"40 TO 42"</span>, <span class="st">"43 TO 45"</span>, <span class="st">"46 TO 48"</span>, <span class="st">"49 TO 51"</span>) </span>
<span id="cb228-965"><a href="#cb228-965" aria-hidden="true" tabindex="-1"></a>story_ordinal <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(story_levels)  <span class="co"># Create the ordinal variable based on the story column </span></span>
<span id="cb228-966"><a href="#cb228-966" aria-hidden="true" tabindex="-1"></a>resale<span class="sc">$</span>Story_Ordinal <span class="ot">&lt;-</span> story_ordinal[<span class="fu">match</span>(resale<span class="sc">$</span>storey_range, story_levels)]  <span class="co"># Set the labels for the ordinal variable </span></span>
<span id="cb228-967"><a href="#cb228-967" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(resale<span class="sc">$</span>Story_Ordinal) <span class="ot">&lt;-</span> story_levels</span>
<span id="cb228-968"><a href="#cb228-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-969"><a href="#cb228-969" aria-hidden="true" tabindex="-1"></a><span class="co"># Lastly, we mutate the ordinal variable as a numeric</span></span>
<span id="cb228-970"><a href="#cb228-970" aria-hidden="true" tabindex="-1"></a>resale<span class="ot">&lt;-</span> resale <span class="sc">|&gt;</span> </span>
<span id="cb228-971"><a href="#cb228-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Story_Ordinal=</span><span class="fu">as.numeric</span>(Story_Ordinal))</span>
<span id="cb228-972"><a href="#cb228-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-973"><a href="#cb228-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-974"><a href="#cb228-974" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Remaining lease - mutate to years</span></span>
<span id="cb228-975"><a href="#cb228-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-976"><a href="#cb228-976" aria-hidden="true" tabindex="-1"></a>The code chunk below seeks to convert the remaining lease period to in terms of years.</span>
<span id="cb228-977"><a href="#cb228-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-980"><a href="#cb228-980" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-981"><a href="#cb228-981" aria-hidden="true" tabindex="-1"></a>str_list <span class="ot">&lt;-</span> <span class="fu">str_split</span>(resale<span class="sc">$</span>remaining_lease, <span class="st">" "</span>)</span>
<span id="cb228-982"><a href="#cb228-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-983"><a href="#cb228-983" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(str_list)) {</span>
<span id="cb228-984"><a href="#cb228-984" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unlist</span>(str_list[i])) <span class="sc">&gt;</span> <span class="dv">2</span>) {</span>
<span id="cb228-985"><a href="#cb228-985" aria-hidden="true" tabindex="-1"></a>      year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb228-986"><a href="#cb228-986" aria-hidden="true" tabindex="-1"></a>      month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">3</span>])</span>
<span id="cb228-987"><a href="#cb228-987" aria-hidden="true" tabindex="-1"></a>      resale<span class="sc">$</span>remaining_lease[i] <span class="ot">&lt;-</span> year <span class="sc">+</span> <span class="fu">round</span>(month<span class="sc">/</span><span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb228-988"><a href="#cb228-988" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb228-989"><a href="#cb228-989" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb228-990"><a href="#cb228-990" aria-hidden="true" tabindex="-1"></a>    year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb228-991"><a href="#cb228-991" aria-hidden="true" tabindex="-1"></a>    resale<span class="sc">$</span>remaining_lease[i] <span class="ot">&lt;-</span> year</span>
<span id="cb228-992"><a href="#cb228-992" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb228-993"><a href="#cb228-993" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-994"><a href="#cb228-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-995"><a href="#cb228-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-996"><a href="#cb228-996" aria-hidden="true" tabindex="-1"></a><span class="fu">### Locational Factors</span></span>
<span id="cb228-997"><a href="#cb228-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-998"><a href="#cb228-998" aria-hidden="true" tabindex="-1"></a>This includes factors that concern location of amenities to the flat in question. For instance, Proximity to CBD or number of primary schools withi 350 m from the flat in question.</span>
<span id="cb228-999"><a href="#cb228-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1000"><a href="#cb228-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">#### CBD Location</span></span>
<span id="cb228-1001"><a href="#cb228-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1002"><a href="#cb228-1002" aria-hidden="true" tabindex="-1"></a>We need to factor in the proximity to CBD in the downtown core. As such let's take the coordinates of Downtown Core to be the coordinates of the CBD</span>
<span id="cb228-1003"><a href="#cb228-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1006"><a href="#cb228-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1007"><a href="#cb228-1007" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fl">1.287953</span></span>
<span id="cb228-1008"><a href="#cb228-1008" aria-hidden="true" tabindex="-1"></a>lng <span class="ot">&lt;-</span> <span class="fl">103.851784</span></span>
<span id="cb228-1009"><a href="#cb228-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1010"><a href="#cb228-1010" aria-hidden="true" tabindex="-1"></a>cbd.sf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lat, lng) <span class="sc">%&gt;%</span></span>
<span id="cb228-1011"><a href="#cb228-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lng"</span>, <span class="st">"lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb228-1012"><a href="#cb228-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span>
<span id="cb228-1013"><a href="#cb228-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1014"><a href="#cb228-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1015"><a href="#cb228-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Proximity Distance Calculation</span></span>
<span id="cb228-1016"><a href="#cb228-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1017"><a href="#cb228-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Converting resale df into sf object</span></span>
<span id="cb228-1018"><a href="#cb228-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1021"><a href="#cb228-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1022"><a href="#cb228-1022" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(resale, </span>
<span id="cb228-1023"><a href="#cb228-1023" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, </span>
<span id="cb228-1024"><a href="#cb228-1024" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"LATITUDE"</span>), </span>
<span id="cb228-1025"><a href="#cb228-1025" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb228-1026"><a href="#cb228-1026" aria-hidden="true" tabindex="-1"></a>  <span class="co">#afterwards, we transform it to SVY21, our desired CRS</span></span>
<span id="cb228-1027"><a href="#cb228-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb228-1028"><a href="#cb228-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1029"><a href="#cb228-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1030"><a href="#cb228-1030" aria-hidden="true" tabindex="-1"></a>One of the things we need to find is the proximity to particular facilities - which we can compute with st_distance(), and find the closest facility (shortest distance) with the rowMins() function of our matrixStats package. The values will be appended to the data frame as a new column.</span>
<span id="cb228-1031"><a href="#cb228-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1032"><a href="#cb228-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-1033"><a href="#cb228-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(units)</span>
<span id="cb228-1034"><a href="#cb228-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb228-1035"><a href="#cb228-1035" aria-hidden="true" tabindex="-1"></a>proximity <span class="ot">&lt;-</span> <span class="cf">function</span>(df1, df2, varname) {</span>
<span id="cb228-1036"><a href="#cb228-1036" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(df1, df2) <span class="sc">|&gt;</span> </span>
<span id="cb228-1037"><a href="#cb228-1037" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_units</span>()</span>
<span id="cb228-1038"><a href="#cb228-1038" aria-hidden="true" tabindex="-1"></a>  df1[,varname] <span class="ot">&lt;-</span> <span class="fu">rowMins</span>(dist_matrix)</span>
<span id="cb228-1039"><a href="#cb228-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df1)</span>
<span id="cb228-1040"><a href="#cb228-1040" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-1041"><a href="#cb228-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1042"><a href="#cb228-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1043"><a href="#cb228-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Implementation</span></span>
<span id="cb228-1044"><a href="#cb228-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1045"><a href="#cb228-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-1046"><a href="#cb228-1046" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1047"><a href="#cb228-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, cbd.sf, <span class="st">"PROX_CBD"</span>)</span>
<span id="cb228-1048"><a href="#cb228-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1049"><a href="#cb228-1049" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1050"><a href="#cb228-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, eldercare.sf, <span class="st">"PROX_ELDERCARE"</span>)</span>
<span id="cb228-1051"><a href="#cb228-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1052"><a href="#cb228-1052" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1053"><a href="#cb228-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, hawkercentre.sf, <span class="st">"PROX_HAWKERCENTRE"</span>)</span>
<span id="cb228-1054"><a href="#cb228-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1055"><a href="#cb228-1055" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1056"><a href="#cb228-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, childcare.sf, <span class="st">"PROX_CHILDCARE"</span>)</span>
<span id="cb228-1057"><a href="#cb228-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1058"><a href="#cb228-1058" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1059"><a href="#cb228-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, kindergartens.sf, <span class="st">"PROX_KINDERGARTEN"</span>)</span>
<span id="cb228-1060"><a href="#cb228-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1061"><a href="#cb228-1061" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1062"><a href="#cb228-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, parks.sf, <span class="st">"PROX_PARK"</span>)</span>
<span id="cb228-1063"><a href="#cb228-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1064"><a href="#cb228-1064" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1065"><a href="#cb228-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, library.sf, <span class="st">"PROX_LIBRARY"</span>)</span>
<span id="cb228-1066"><a href="#cb228-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1067"><a href="#cb228-1067" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1068"><a href="#cb228-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, sport.sf, <span class="st">"PROX_SPORT"</span>)</span>
<span id="cb228-1069"><a href="#cb228-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1070"><a href="#cb228-1070" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1071"><a href="#cb228-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, busstop.sf, <span class="st">"PROX_BUSSTOP"</span>)</span>
<span id="cb228-1072"><a href="#cb228-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1073"><a href="#cb228-1073" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1074"><a href="#cb228-1074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, shoppingmall.sf, <span class="st">"PROX_SHOPPINGMALL"</span>)</span>
<span id="cb228-1075"><a href="#cb228-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1076"><a href="#cb228-1076" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1077"><a href="#cb228-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, supermarket.sf, <span class="st">"PROX_SUPERMARKET"</span>)</span>
<span id="cb228-1078"><a href="#cb228-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1079"><a href="#cb228-1079" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1080"><a href="#cb228-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, primarysch.sf, <span class="st">"PROX_PRIMARYSCH"</span>)</span>
<span id="cb228-1081"><a href="#cb228-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1082"><a href="#cb228-1082" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1083"><a href="#cb228-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, goodprimarysch.sf, <span class="st">"PROX_GOODPRIMARYSCH"</span>)</span>
<span id="cb228-1084"><a href="#cb228-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1085"><a href="#cb228-1085" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1086"><a href="#cb228-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(resale.sf, mrt.sf, <span class="st">"PROX_MRT"</span>)</span>
<span id="cb228-1087"><a href="#cb228-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1088"><a href="#cb228-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1089"><a href="#cb228-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Facility Count within radius calculation</span></span>
<span id="cb228-1090"><a href="#cb228-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1091"><a href="#cb228-1091" aria-hidden="true" tabindex="-1"></a>Besides proximity, which calculates the shortest distance, we also want to find the number of facilities within a particular radius.</span>
<span id="cb228-1092"><a href="#cb228-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1095"><a href="#cb228-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1096"><a href="#cb228-1096" aria-hidden="true" tabindex="-1"></a>num_radius <span class="ot">&lt;-</span> <span class="cf">function</span>(df1, df2, varname, radius) {</span>
<span id="cb228-1097"><a href="#cb228-1097" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(df1, df2) <span class="sc">%&gt;%</span></span>
<span id="cb228-1098"><a href="#cb228-1098" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_units</span>() <span class="sc">%&gt;%</span></span>
<span id="cb228-1099"><a href="#cb228-1099" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb228-1100"><a href="#cb228-1100" aria-hidden="true" tabindex="-1"></a>  df1[,varname] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dist_matrix <span class="sc">&lt;=</span> radius)</span>
<span id="cb228-1101"><a href="#cb228-1101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df1)</span>
<span id="cb228-1102"><a href="#cb228-1102" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb228-1103"><a href="#cb228-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1104"><a href="#cb228-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1105"><a href="#cb228-1105" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Implementation</span></span>
<span id="cb228-1106"><a href="#cb228-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1107"><a href="#cb228-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1108"><a href="#cb228-1108" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span> </span>
<span id="cb228-1109"><a href="#cb228-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, busstop.sf, <span class="st">"NUM_BUSSTOP"</span>, <span class="dv">350</span>)</span>
<span id="cb228-1110"><a href="#cb228-1110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-1111"><a href="#cb228-1111" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span></span>
<span id="cb228-1112"><a href="#cb228-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, childcare.sf, <span class="st">"NUM_CHILDCARE"</span>, <span class="dv">350</span>)</span>
<span id="cb228-1113"><a href="#cb228-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1114"><a href="#cb228-1114" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span></span>
<span id="cb228-1115"><a href="#cb228-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, kindergartens.sf, <span class="st">"NUM_KINDERGARTEN"</span>, <span class="dv">350</span>)</span>
<span id="cb228-1116"><a href="#cb228-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1117"><a href="#cb228-1117" aria-hidden="true" tabindex="-1"></a>resale.sf <span class="ot">&lt;-</span></span>
<span id="cb228-1118"><a href="#cb228-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(resale.sf, primarysch.sf, <span class="st">"NUM_PRIMARYSCH"</span>, <span class="dv">1000</span>)</span>
<span id="cb228-1119"><a href="#cb228-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1120"><a href="#cb228-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1121"><a href="#cb228-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Saving Resale.sf as a rds file</span></span>
<span id="cb228-1122"><a href="#cb228-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1123"><a href="#cb228-1123" aria-hidden="true" tabindex="-1"></a>We are finally done with the inclusion of our prox and num variables 😫. We can now save our rds object into our model file for easy retrieval!</span>
<span id="cb228-1124"><a href="#cb228-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1125"><a href="#cb228-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-1126"><a href="#cb228-1126" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(resale.sf, <span class="st">"data/model/resale.sf.rds"</span>)</span>
<span id="cb228-1127"><a href="#cb228-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1128"><a href="#cb228-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1129"><a href="#cb228-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Reading rds file</span></span>
<span id="cb228-1130"><a href="#cb228-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1133"><a href="#cb228-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1134"><a href="#cb228-1134" aria-hidden="true" tabindex="-1"></a>resale.sf<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/resale.sf.rds"</span>)</span>
<span id="cb228-1135"><a href="#cb228-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1136"><a href="#cb228-1136" aria-hidden="true" tabindex="-1"></a>resale.sf<span class="ot">&lt;-</span>resale.sf <span class="sc">|&gt;</span> </span>
<span id="cb228-1137"><a href="#cb228-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LEASE_YRS=</span><span class="fu">as.double</span>(LEASE_YRS))</span>
<span id="cb228-1138"><a href="#cb228-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1139"><a href="#cb228-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1140"><a href="#cb228-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regressions {#regressions-1}</span></span>
<span id="cb228-1141"><a href="#cb228-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1142"><a href="#cb228-1142" aria-hidden="true" tabindex="-1"></a>With all our data prepared, we are now ready to look into regressing the data to create our prediction models! In particular, we explored the use of OLS, geographical weighted regression, random forest and geographical random forest in this section. 🌳🌲🌴</span>
<span id="cb228-1143"><a href="#cb228-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1144"><a href="#cb228-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Preparation</span></span>
<span id="cb228-1145"><a href="#cb228-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1146"><a href="#cb228-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Building a correlation matrix</span></span>
<span id="cb228-1147"><a href="#cb228-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1148"><a href="#cb228-1148" aria-hidden="true" tabindex="-1"></a>In order to avoid issues of multicollinearity in regression models, we first visualise our data using a correlation matrix.</span>
<span id="cb228-1149"><a href="#cb228-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1152"><a href="#cb228-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1153"><a href="#cb228-1153" aria-hidden="true" tabindex="-1"></a>resale_nogeo <span class="ot">&lt;-</span> resale.sf <span class="sc">|&gt;</span> </span>
<span id="cb228-1154"><a href="#cb228-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span> </span>
<span id="cb228-1155"><a href="#cb228-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb228-1156"><a href="#cb228-1156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>PRICE)</span>
<span id="cb228-1157"><a href="#cb228-1157" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="fu">cor</span>(resale_nogeo), </span>
<span id="cb228-1158"><a href="#cb228-1158" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag =</span> <span class="cn">FALSE</span>, </span>
<span id="cb228-1159"><a href="#cb228-1159" aria-hidden="true" tabindex="-1"></a>                   <span class="at">order =</span> <span class="st">"AOE"</span>,</span>
<span id="cb228-1160"><a href="#cb228-1160" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.pos =</span> <span class="st">"td"</span>, </span>
<span id="cb228-1161"><a href="#cb228-1161" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.cex =</span> <span class="fl">0.5</span>, </span>
<span id="cb228-1162"><a href="#cb228-1162" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"number"</span>, </span>
<span id="cb228-1163"><a href="#cb228-1163" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">"upper"</span>)</span>
<span id="cb228-1164"><a href="#cb228-1164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1165"><a href="#cb228-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1166"><a href="#cb228-1166" aria-hidden="true" tabindex="-1"></a>We realise that the variables "lease_commence_date" which is the beginning year of lease, and "LEASE_YRS" which is the number of years left in the lease, are perfectly collinear with a correlation coeffecient of 1. We choose to drop "lease_commence_date" to avoid the problem of perfect collinearity. This creates our final resale df ("resale_final").</span>
<span id="cb228-1167"><a href="#cb228-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1170"><a href="#cb228-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1171"><a href="#cb228-1171" aria-hidden="true" tabindex="-1"></a>resale_final <span class="ot">&lt;-</span> resale.sf <span class="sc">|&gt;</span> </span>
<span id="cb228-1172"><a href="#cb228-1172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lease_commence_date)</span>
<span id="cb228-1173"><a href="#cb228-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1174"><a href="#cb228-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1175"><a href="#cb228-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Splitting data into test and training set</span></span>
<span id="cb228-1176"><a href="#cb228-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1177"><a href="#cb228-1177" aria-hidden="true" tabindex="-1"></a>From the assignment brief, our training data consists of transactions that occurred from 1st January 2021 to 31st December 2022, while test data occurred from January and February 2023.</span>
<span id="cb228-1178"><a href="#cb228-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1181"><a href="#cb228-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1182"><a href="#cb228-1182" aria-hidden="true" tabindex="-1"></a>train_data<span class="ot">&lt;-</span>resale_final <span class="sc">|&gt;</span> </span>
<span id="cb228-1183"><a href="#cb228-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2021-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2022-12"</span>)</span>
<span id="cb228-1184"><a href="#cb228-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1185"><a href="#cb228-1185" aria-hidden="true" tabindex="-1"></a>test_data<span class="ot">&lt;-</span>resale_final <span class="sc">|&gt;</span> </span>
<span id="cb228-1186"><a href="#cb228-1186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2023-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2023-02"</span>)</span>
<span id="cb228-1187"><a href="#cb228-1187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1188"><a href="#cb228-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1189"><a href="#cb228-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">### Building a non spatial multiple linear regression</span></span>
<span id="cb228-1190"><a href="#cb228-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1191"><a href="#cb228-1191" aria-hidden="true" tabindex="-1"></a>First we explored the creation of an OLS model in the code chunk below:</span>
<span id="cb228-1192"><a href="#cb228-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1193"><a href="#cb228-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-1194"><a href="#cb228-1194" aria-hidden="true" tabindex="-1"></a>price_mlr<span class="ot">&lt;-</span> <span class="fu">lm</span>(PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH, <span class="at">data=</span>train_data)</span>
<span id="cb228-1195"><a href="#cb228-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#removed flat type given that we only consider 4 room flats</span></span>
<span id="cb228-1196"><a href="#cb228-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#remove geographical variables given GWR</span></span>
<span id="cb228-1197"><a href="#cb228-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#removed month &lt;- questionable interpretability of coefficient (if generated)</span></span>
<span id="cb228-1198"><a href="#cb228-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1199"><a href="#cb228-1199" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(price_mlr)</span>
<span id="cb228-1200"><a href="#cb228-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1201"><a href="#cb228-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb228-1202"><a href="#cb228-1202" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(price_mlr, <span class="st">"data/model/price_mlr.rds"</span>)</span>
<span id="cb228-1203"><a href="#cb228-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1204"><a href="#cb228-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1205"><a href="#cb228-1205" aria-hidden="true" tabindex="-1"></a>We can read the output below</span>
<span id="cb228-1206"><a href="#cb228-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1209"><a href="#cb228-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1210"><a href="#cb228-1210" aria-hidden="true" tabindex="-1"></a>price_mlr_summary<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/price_mlr.rds"</span>)</span>
<span id="cb228-1211"><a href="#cb228-1211" aria-hidden="true" tabindex="-1"></a>price_mlr_summary</span>
<span id="cb228-1212"><a href="#cb228-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1213"><a href="#cb228-1213" aria-hidden="true" tabindex="-1"></a><span class="co"># a more elegant way of visualising the summary table can be done through using the gtsummary package!</span></span>
<span id="cb228-1214"><a href="#cb228-1214" aria-hidden="true" tabindex="-1"></a>price_mlr<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/price_mlr.rds"</span>)</span>
<span id="cb228-1215"><a href="#cb228-1215" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(price_mlr)</span>
<span id="cb228-1216"><a href="#cb228-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1217"><a href="#cb228-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1218"><a href="#cb228-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">### GWR predictive method</span></span>
<span id="cb228-1219"><a href="#cb228-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1220"><a href="#cb228-1220" aria-hidden="true" tabindex="-1"></a>gwr method will be used to calibrate a model to predict the HDB resale prices.</span>
<span id="cb228-1221"><a href="#cb228-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1222"><a href="#cb228-1222" aria-hidden="true" tabindex="-1"></a>We first need to convert the sf data.frame to a SpatialPointDataFrame</span>
<span id="cb228-1223"><a href="#cb228-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1226"><a href="#cb228-1226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1227"><a href="#cb228-1227" aria-hidden="true" tabindex="-1"></a>train_data_sp<span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">as_Spatial</span>(train_data)</span>
<span id="cb228-1228"><a href="#cb228-1228" aria-hidden="true" tabindex="-1"></a>train_data_sp</span>
<span id="cb228-1229"><a href="#cb228-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1230"><a href="#cb228-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1231"><a href="#cb228-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Computing adaptive bandwidth</span></span>
<span id="cb228-1232"><a href="#cb228-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1233"><a href="#cb228-1233" aria-hidden="true" tabindex="-1"></a>Next, bw.gwr() of GWmodel package will be used to determine the optimal bandwidth to be used.</span>
<span id="cb228-1234"><a href="#cb228-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1235"><a href="#cb228-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-1236"><a href="#cb228-1236" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH,</span>
<span id="cb228-1237"><a href="#cb228-1237" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>train_data_sp,</span>
<span id="cb228-1238"><a href="#cb228-1238" aria-hidden="true" tabindex="-1"></a>                  <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb228-1239"><a href="#cb228-1239" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb228-1240"><a href="#cb228-1240" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb228-1241"><a href="#cb228-1241" aria-hidden="true" tabindex="-1"></a>                  <span class="at">longlat=</span><span class="cn">FALSE</span>)</span>
<span id="cb228-1242"><a href="#cb228-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1243"><a href="#cb228-1243" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb228-1244"><a href="#cb228-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_adaptive, <span class="st">"data/model/bw_adaptive.rds"</span>)</span>
<span id="cb228-1245"><a href="#cb228-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1246"><a href="#cb228-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1247"><a href="#cb228-1247" aria-hidden="true" tabindex="-1"></a>The code below can be used to display the model output.</span>
<span id="cb228-1248"><a href="#cb228-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1251"><a href="#cb228-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1252"><a href="#cb228-1252" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/bw_adaptive.rds"</span>)</span>
<span id="cb228-1253"><a href="#cb228-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1254"><a href="#cb228-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1255"><a href="#cb228-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Constructing gwr model</span></span>
<span id="cb228-1256"><a href="#cb228-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1257"><a href="#cb228-1257" aria-hidden="true" tabindex="-1"></a>Forming model</span>
<span id="cb228-1258"><a href="#cb228-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1259"><a href="#cb228-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-1260"><a href="#cb228-1260" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH,</span>
<span id="cb228-1261"><a href="#cb228-1261" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data=</span>train_data_sp,</span>
<span id="cb228-1262"><a href="#cb228-1262" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw=</span>bw_adaptive, </span>
<span id="cb228-1263"><a href="#cb228-1263" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb228-1264"><a href="#cb228-1264" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb228-1265"><a href="#cb228-1265" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-1266"><a href="#cb228-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1267"><a href="#cb228-1267" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb228-1268"><a href="#cb228-1268" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_adaptive, <span class="st">"data/model/gwr_adaptive.rds"</span>)</span>
<span id="cb228-1269"><a href="#cb228-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1270"><a href="#cb228-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1271"><a href="#cb228-1271" aria-hidden="true" tabindex="-1"></a>The code below can be used to display the model output.</span>
<span id="cb228-1272"><a href="#cb228-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1275"><a href="#cb228-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1276"><a href="#cb228-1276" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/gwr_adaptive.rds"</span>)</span>
<span id="cb228-1277"><a href="#cb228-1277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1278"><a href="#cb228-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1279"><a href="#cb228-1279" aria-hidden="true" tabindex="-1"></a><span class="fu">### Preparing coordinates data</span></span>
<span id="cb228-1280"><a href="#cb228-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1281"><a href="#cb228-1281" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extracting coordinates data</span></span>
<span id="cb228-1282"><a href="#cb228-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1283"><a href="#cb228-1283" aria-hidden="true" tabindex="-1"></a>The code chunk below extracts the x, y coordinates of the full training and test data sets.</span>
<span id="cb228-1284"><a href="#cb228-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1285"><a href="#cb228-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1286"><a href="#cb228-1286" aria-hidden="true" tabindex="-1"></a>coords<span class="ot">&lt;-</span><span class="fu">st_coordinates</span>(resale_final)</span>
<span id="cb228-1287"><a href="#cb228-1287" aria-hidden="true" tabindex="-1"></a>coords_train<span class="ot">&lt;-</span><span class="fu">st_coordinates</span>(train_data)</span>
<span id="cb228-1288"><a href="#cb228-1288" aria-hidden="true" tabindex="-1"></a>coords_test<span class="ot">&lt;-</span><span class="fu">st_coordinates</span>(test_data)</span>
<span id="cb228-1289"><a href="#cb228-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1290"><a href="#cb228-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1291"><a href="#cb228-1291" aria-hidden="true" tabindex="-1"></a>Save into rds</span>
<span id="cb228-1292"><a href="#cb228-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1293"><a href="#cb228-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1294"><a href="#cb228-1294" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(coords_train, <span class="st">"data/model/coords_train.rds"</span>)</span>
<span id="cb228-1295"><a href="#cb228-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(coords_test, <span class="st">"data/model/coords_test.rds"</span>)</span>
<span id="cb228-1296"><a href="#cb228-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1297"><a href="#cb228-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1298"><a href="#cb228-1298" aria-hidden="true" tabindex="-1"></a>Read RDS</span>
<span id="cb228-1299"><a href="#cb228-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1302"><a href="#cb228-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1303"><a href="#cb228-1303" aria-hidden="true" tabindex="-1"></a>coords_train<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/coords_train.rds"</span>)</span>
<span id="cb228-1304"><a href="#cb228-1304" aria-hidden="true" tabindex="-1"></a>coords_test<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/coords_test.rds"</span>)</span>
<span id="cb228-1305"><a href="#cb228-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1306"><a href="#cb228-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1307"><a href="#cb228-1307" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dropping geometry field</span></span>
<span id="cb228-1308"><a href="#cb228-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1309"><a href="#cb228-1309" aria-hidden="true" tabindex="-1"></a>Drop geometry column of the sf dataframe by using st_drop_geometry()</span>
<span id="cb228-1310"><a href="#cb228-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1311"><a href="#cb228-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1312"><a href="#cb228-1312" aria-hidden="true" tabindex="-1"></a>train_data<span class="ot">&lt;-</span>train_data <span class="sc">|&gt;</span> </span>
<span id="cb228-1313"><a href="#cb228-1313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span>
<span id="cb228-1314"><a href="#cb228-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1315"><a href="#cb228-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(train_data, <span class="st">"data/model/train_data.rds"</span>)</span>
<span id="cb228-1316"><a href="#cb228-1316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1317"><a href="#cb228-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1318"><a href="#cb228-1318" aria-hidden="true" tabindex="-1"></a>Read RDS</span>
<span id="cb228-1319"><a href="#cb228-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1322"><a href="#cb228-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1323"><a href="#cb228-1323" aria-hidden="true" tabindex="-1"></a>train_data<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/train_data.rds"</span>)</span>
<span id="cb228-1324"><a href="#cb228-1324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1325"><a href="#cb228-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1326"><a href="#cb228-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calibrating Random Forest Model</span></span>
<span id="cb228-1327"><a href="#cb228-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1328"><a href="#cb228-1328" aria-hidden="true" tabindex="-1"></a>In this section, we will to calibrate a model to predict HDB resale price by using random forest function of ranger package. 🌳🌲🌴🌳🌲🌴</span>
<span id="cb228-1329"><a href="#cb228-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1330"><a href="#cb228-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">#### forming model</span></span>
<span id="cb228-1331"><a href="#cb228-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1332"><a href="#cb228-1332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1333"><a href="#cb228-1333" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) </span>
<span id="cb228-1334"><a href="#cb228-1334" aria-hidden="true" tabindex="-1"></a>rf<span class="ot">&lt;-</span> <span class="fu">ranger</span>(PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH, <span class="at">data=</span>train_data)</span>
<span id="cb228-1335"><a href="#cb228-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1336"><a href="#cb228-1336" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rf)</span>
<span id="cb228-1337"><a href="#cb228-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1338"><a href="#cb228-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb228-1339"><a href="#cb228-1339" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rf, <span class="st">"data/model/rf.rds"</span>)</span>
<span id="cb228-1340"><a href="#cb228-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1341"><a href="#cb228-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1342"><a href="#cb228-1342" aria-hidden="true" tabindex="-1"></a>read RDS object</span>
<span id="cb228-1343"><a href="#cb228-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1346"><a href="#cb228-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1347"><a href="#cb228-1347" aria-hidden="true" tabindex="-1"></a>rf<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/rf.rds"</span>)</span>
<span id="cb228-1348"><a href="#cb228-1348" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf)</span>
<span id="cb228-1349"><a href="#cb228-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1350"><a href="#cb228-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1351"><a href="#cb228-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calibrating Geographic random forest using grf</span></span>
<span id="cb228-1352"><a href="#cb228-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1353"><a href="#cb228-1353" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Computing bandwidth for grf</span></span>
<span id="cb228-1354"><a href="#cb228-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1355"><a href="#cb228-1355" aria-hidden="true" tabindex="-1"></a>Minimise trees to trees=50 for ease of computation.</span>
<span id="cb228-1356"><a href="#cb228-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1357"><a href="#cb228-1357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1358"><a href="#cb228-1358" aria-hidden="true" tabindex="-1"></a><span class="co"># determining bandwidth for model</span></span>
<span id="cb228-1359"><a href="#cb228-1359" aria-hidden="true" tabindex="-1"></a>bw_grf_adaptive<span class="ot">&lt;-</span><span class="fu">grf.bw</span>(<span class="at">formula =</span> PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH, <span class="at">dataset =</span> train_data, <span class="at">kernel =</span> <span class="st">"adaptive"</span>, <span class="at">coords =</span> coords_train, <span class="at">trees=</span><span class="dv">50</span>)</span>
<span id="cb228-1360"><a href="#cb228-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1361"><a href="#cb228-1361" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb228-1362"><a href="#cb228-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_grf_adaptive, <span class="st">"data/model/bw_grf_adaptive.rds"</span>)</span>
<span id="cb228-1363"><a href="#cb228-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1364"><a href="#cb228-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1365"><a href="#cb228-1365" aria-hidden="true" tabindex="-1"></a>we were unable to gain the bandwidth result even after extensive waiting. For the assignment requirements, we will consider the bandwidths generated and choose the one that gives the highest R2 value. The output generated can be seen in the screenshots attached:</span>
<span id="cb228-1366"><a href="#cb228-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1367"><a href="#cb228-1367" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/photo_2023-03-22_20-54-38.jpg)</span></span>
<span id="cb228-1368"><a href="#cb228-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1369"><a href="#cb228-1369" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/photo_2023-03-22_20-54-42.jpg)</span></span>
<span id="cb228-1370"><a href="#cb228-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1371"><a href="#cb228-1371" aria-hidden="true" tabindex="-1"></a>From our data gathered, we find that the optimal bandwidth within the bandwidths calculated is when bandwidth = 1211. We then assign this to the bw_grf_adaptive object</span>
<span id="cb228-1372"><a href="#cb228-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1375"><a href="#cb228-1375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1376"><a href="#cb228-1376" aria-hidden="true" tabindex="-1"></a>bw_grf_adaptive<span class="ot">&lt;-</span><span class="dv">1211</span></span>
<span id="cb228-1377"><a href="#cb228-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1378"><a href="#cb228-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1379"><a href="#cb228-1379" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Generating model</span></span>
<span id="cb228-1380"><a href="#cb228-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1381"><a href="#cb228-1381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb228-1382"><a href="#cb228-1382" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb228-1383"><a href="#cb228-1383" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive<span class="ot">&lt;-</span><span class="fu">grf</span>(<span class="at">formula =</span> PRICE<span class="sc">~</span> Story_Ordinal <span class="sc">+</span> LEASE_YRS <span class="sc">+</span> AREA_SQM <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_HAWKERCENTRE <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_LIBRARY <span class="sc">+</span> PROX_SPORT <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_SHOPPINGMALL <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_GOODPRIMARYSCH <span class="sc">+</span> PROX_MRT <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_PRIMARYSCH,</span>
<span id="cb228-1384"><a href="#cb228-1384" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dframe=</span>train_data,</span>
<span id="cb228-1385"><a href="#cb228-1385" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bw=</span>bw_grf_adaptive, <span class="co"># need to know how to calculate using function</span></span>
<span id="cb228-1386"><a href="#cb228-1386" aria-hidden="true" tabindex="-1"></a>                   <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb228-1387"><a href="#cb228-1387" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coords=</span>coords_train,</span>
<span id="cb228-1388"><a href="#cb228-1388" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ntree=</span><span class="dv">50</span>)</span>
<span id="cb228-1389"><a href="#cb228-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1390"><a href="#cb228-1390" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the result as an rds object</span></span>
<span id="cb228-1391"><a href="#cb228-1391" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive, <span class="st">"data/model/gwRF_adaptive.rds"</span>)</span>
<span id="cb228-1392"><a href="#cb228-1392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1393"><a href="#cb228-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1394"><a href="#cb228-1394" aria-hidden="true" tabindex="-1"></a>The output rds file generated is 31.7GB, which is larger than what is recommended to push into Git. Therefore, we append screenshots of our outputs instead. 🌳🌲🌴🌳🌲🌴</span>
<span id="cb228-1395"><a href="#cb228-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1396"><a href="#cb228-1396" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/image_2023-03-24_08-35-58.png)![](images/image_2023-03-24_09-03-48.png)![](images/photo_2023-03-24_11-26-06.jpg)![](images/photo_2023-03-24_11-26-09.jpg)</span></span>
<span id="cb228-1397"><a href="#cb228-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1398"><a href="#cb228-1398" aria-hidden="true" tabindex="-1"></a><span class="fu">## Predictions</span></span>
<span id="cb228-1399"><a href="#cb228-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1400"><a href="#cb228-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">### Preparing the test data</span></span>
<span id="cb228-1401"><a href="#cb228-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1402"><a href="#cb228-1402" aria-hidden="true" tabindex="-1"></a>The code chunk below will be used to combine the test data with the corresponding coordinates data.</span>
<span id="cb228-1403"><a href="#cb228-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1404"><a href="#cb228-1404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1405"><a href="#cb228-1405" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, coords_test) <span class="sc">%&gt;%</span></span>
<span id="cb228-1406"><a href="#cb228-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span>
<span id="cb228-1407"><a href="#cb228-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1408"><a href="#cb228-1408" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data, <span class="st">"data/model/test_data.rds"</span>)</span>
<span id="cb228-1409"><a href="#cb228-1409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1410"><a href="#cb228-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1411"><a href="#cb228-1411" aria-hidden="true" tabindex="-1"></a><span class="fu">### Predicting with test data</span></span>
<span id="cb228-1412"><a href="#cb228-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1413"><a href="#cb228-1413" aria-hidden="true" tabindex="-1"></a>Next, predict.grf() of spatialML package will be used to predict the resale value by using the test data and gwRF_adaptive model calibrated earlier.</span>
<span id="cb228-1414"><a href="#cb228-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1415"><a href="#cb228-1415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb228-1416"><a href="#cb228-1416" aria-hidden="true" tabindex="-1"></a>gwRF_pred <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive, </span>
<span id="cb228-1417"><a href="#cb228-1417" aria-hidden="true" tabindex="-1"></a>                           test_data, </span>
<span id="cb228-1418"><a href="#cb228-1418" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb228-1419"><a href="#cb228-1419" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y.var.name=</span><span class="st">"Y"</span>, </span>
<span id="cb228-1420"><a href="#cb228-1420" aria-hidden="true" tabindex="-1"></a>                           <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb228-1421"><a href="#cb228-1421" aria-hidden="true" tabindex="-1"></a>                           <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb228-1422"><a href="#cb228-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1423"><a href="#cb228-1423" aria-hidden="true" tabindex="-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(gwRF_pred, <span class="st">"data/model/GRF_pred.rds"</span>)</span>
<span id="cb228-1424"><a href="#cb228-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1425"><a href="#cb228-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1426"><a href="#cb228-1426" aria-hidden="true" tabindex="-1"></a><span class="fu">### Converting the prediction output into a dataframe</span></span>
<span id="cb228-1427"><a href="#cb228-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1428"><a href="#cb228-1428" aria-hidden="true" tabindex="-1"></a>The output of the predict.grf() is a vector of predicted values. It is wiser to convert it into a data frame for further visualisation and analysis.</span>
<span id="cb228-1429"><a href="#cb228-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1432"><a href="#cb228-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1433"><a href="#cb228-1433" aria-hidden="true" tabindex="-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/GRF_pred.rds"</span>)</span>
<span id="cb228-1434"><a href="#cb228-1434" aria-hidden="true" tabindex="-1"></a>GRF_pred_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(GRF_pred)</span>
<span id="cb228-1435"><a href="#cb228-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1436"><a href="#cb228-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1437"><a href="#cb228-1437" aria-hidden="true" tabindex="-1"></a>In the code chunk below, cbind() is used to append the predicted values onto test_data.</span>
<span id="cb228-1438"><a href="#cb228-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1441"><a href="#cb228-1441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1442"><a href="#cb228-1442" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, GRF_pred_df)</span>
<span id="cb228-1443"><a href="#cb228-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1444"><a href="#cb228-1444" aria-hidden="true" tabindex="-1"></a><span class="co">#save this as an rds object</span></span>
<span id="cb228-1445"><a href="#cb228-1445" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_p, <span class="st">"data/model/test_data_p.rds"</span>)</span>
<span id="cb228-1446"><a href="#cb228-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1447"><a href="#cb228-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1448"><a href="#cb228-1448" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating Root Mean Square Error</span></span>
<span id="cb228-1449"><a href="#cb228-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1450"><a href="#cb228-1450" aria-hidden="true" tabindex="-1"></a>The root mean square error (RMSE) allows us to measure how far predicted values are from observed values in a regression analysis. In the code chunk below, rmse() of Metrics package is used to compute the RMSE.</span>
<span id="cb228-1451"><a href="#cb228-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1454"><a href="#cb228-1454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1455"><a href="#cb228-1455" aria-hidden="true" tabindex="-1"></a>Metrics<span class="sc">::</span><span class="fu">rmse</span>(test_data_p<span class="sc">$</span>PRICE, </span>
<span id="cb228-1456"><a href="#cb228-1456" aria-hidden="true" tabindex="-1"></a>     test_data_p<span class="sc">$</span>GRF_pred)</span>
<span id="cb228-1457"><a href="#cb228-1457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1458"><a href="#cb228-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1459"><a href="#cb228-1459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualising the predicted values</span></span>
<span id="cb228-1460"><a href="#cb228-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1461"><a href="#cb228-1461" aria-hidden="true" tabindex="-1"></a>Alternatively, scatterplot can be used to visualise the actual resale price and the predicted resale price by using the code chunk below.</span>
<span id="cb228-1462"><a href="#cb228-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1465"><a href="#cb228-1465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1466"><a href="#cb228-1466" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb228-1467"><a href="#cb228-1467" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb228-1468"><a href="#cb228-1468" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb228-1469"><a href="#cb228-1469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb228-1470"><a href="#cb228-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1471"><a href="#cb228-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1472"><a href="#cb228-1472" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions: Comparisons</span></span>
<span id="cb228-1473"><a href="#cb228-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1474"><a href="#cb228-1474" aria-hidden="true" tabindex="-1"></a>In the last objective of this take home assignment, a comparison between the conventional OLS method versus the geographically weighted methods should be done.</span>
<span id="cb228-1475"><a href="#cb228-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1476"><a href="#cb228-1476" aria-hidden="true" tabindex="-1"></a>As this task is focused on predictive modelling, a comparison between the OLS method (a method predominantly for explanatory models) and geographical random forest (for predictive modelling with geographical elements).</span>
<span id="cb228-1477"><a href="#cb228-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1478"><a href="#cb228-1478" aria-hidden="true" tabindex="-1"></a>|                   | OLS                                        | Geographical random forest                                  |</span>
<span id="cb228-1479"><a href="#cb228-1479" aria-hidden="true" tabindex="-1"></a>|-------------------|--------------------------------------------|-------------------------------------------------------------|</span>
<span id="cb228-1480"><a href="#cb228-1480" aria-hidden="true" tabindex="-1"></a>| Main purpose      | Explanatory model for standard regressions | Predictive model for regressions with geographical elements |</span>
<span id="cb228-1481"><a href="#cb228-1481" aria-hidden="true" tabindex="-1"></a>| Seeks to minimise | residual sum of squares                    | mean squared error                                          |</span>
<span id="cb228-1482"><a href="#cb228-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1483"><a href="#cb228-1483" aria-hidden="true" tabindex="-1"></a>With a basic understanding of how each model works, we hypothesise that the gwRF model will be the most appropriate for analysis, as it accounts for geographical elements included in the resale flat data, as well as the predictive aspect of this model.</span>
<span id="cb228-1484"><a href="#cb228-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1485"><a href="#cb228-1485" aria-hidden="true" tabindex="-1"></a>To estimate the predictive power of each of the models, we plot each of the predicted values against actual prices in the test data set, and calculate the root MSEs for each of the models.</span>
<span id="cb228-1486"><a href="#cb228-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1487"><a href="#cb228-1487" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb228-1488"><a href="#cb228-1488" aria-hidden="true" tabindex="-1"></a><span class="fu">### OLS</span></span>
<span id="cb228-1489"><a href="#cb228-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1492"><a href="#cb228-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1493"><a href="#cb228-1493" aria-hidden="true" tabindex="-1"></a>price_mlr<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/model/price_mlr.rds"</span>)</span>
<span id="cb228-1494"><a href="#cb228-1494" aria-hidden="true" tabindex="-1"></a>mlr_pred_df<span class="ot">&lt;-</span><span class="fu">predict</span>(price_mlr, test_data)</span>
<span id="cb228-1495"><a href="#cb228-1495" aria-hidden="true" tabindex="-1"></a>test_data_mlr <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, mlr_pred_df)</span>
<span id="cb228-1496"><a href="#cb228-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1497"><a href="#cb228-1497" aria-hidden="true" tabindex="-1"></a>Metrics<span class="sc">::</span><span class="fu">rmse</span>(test_data_mlr<span class="sc">$</span>PRICE, </span>
<span id="cb228-1498"><a href="#cb228-1498" aria-hidden="true" tabindex="-1"></a>     test_data_mlr<span class="sc">$</span>mlr_pred_df)</span>
<span id="cb228-1499"><a href="#cb228-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1500"><a href="#cb228-1500" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_mlr,</span>
<span id="cb228-1501"><a href="#cb228-1501" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> mlr_pred_df,</span>
<span id="cb228-1502"><a href="#cb228-1502" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb228-1503"><a href="#cb228-1503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb228-1504"><a href="#cb228-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1505"><a href="#cb228-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1506"><a href="#cb228-1506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Geographical Random Forest</span></span>
<span id="cb228-1507"><a href="#cb228-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1510"><a href="#cb228-1510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb228-1511"><a href="#cb228-1511" aria-hidden="true" tabindex="-1"></a><span class="co">#detailed code chunks can be found in earlier sections</span></span>
<span id="cb228-1512"><a href="#cb228-1512" aria-hidden="true" tabindex="-1"></a>Metrics<span class="sc">::</span><span class="fu">rmse</span>(test_data_p<span class="sc">$</span>PRICE, </span>
<span id="cb228-1513"><a href="#cb228-1513" aria-hidden="true" tabindex="-1"></a>     test_data_p<span class="sc">$</span>GRF_pred)</span>
<span id="cb228-1514"><a href="#cb228-1514" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb228-1515"><a href="#cb228-1515" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb228-1516"><a href="#cb228-1516" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb228-1517"><a href="#cb228-1517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb228-1518"><a href="#cb228-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb228-1519"><a href="#cb228-1519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb228-1520"><a href="#cb228-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1521"><a href="#cb228-1521" aria-hidden="true" tabindex="-1"></a>From this comparisons, we conclude that the predictive power of geographical weighted random forest was the most powerful to predict resale prices. this affirms our hypothesis that geographical weighted random forest models are the most appropriate for modelling resale flat data. 🌳🌲🌴</span>
<span id="cb228-1522"><a href="#cb228-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1523"><a href="#cb228-1523" aria-hidden="true" tabindex="-1"></a>However, our analysis in this assignment was limited🙁:</span>
<span id="cb228-1524"><a href="#cb228-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1525"><a href="#cb228-1525" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>A key flaw was the limited number of trees we used in each forest generated in the gwRF model. Due to limited capacity of our devices, we set ntree = 50 instead of a higher value. A more comprehensive model could have been created with a stronger device that has greater computational power.</span>
<span id="cb228-1526"><a href="#cb228-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1527"><a href="#cb228-1527" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb228-1528"><a href="#cb228-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1529"><a href="#cb228-1529" aria-hidden="true" tabindex="-1"></a>In the course of this assignment, reference was taken from our senior Megans work. Check out her website here 🤗: <span class="ot">&lt;https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/&gt;</span></span>
<span id="cb228-1530"><a href="#cb228-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-1531"><a href="#cb228-1531" aria-hidden="true" tabindex="-1"></a>We also referenced Prof Kam's in class exercise 9 in this assignment: <span class="ot">&lt;https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex09/in-class_ex09_gwml&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>